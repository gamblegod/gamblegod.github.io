<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Just for fun</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Just for fun">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Just for fun">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Just for fun">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Just for fun" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Just for fun</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Oracle 12c RAC Backup" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/04/Oracle 12c RAC Backup/" class="article-date">
  <time datetime="2016-03-04T01:42:53.000Z" itemprop="datePublished">2016-03-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Oracle-12c/">Oracle 12c</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/04/Oracle 12c RAC Backup/">Oracle 12c RAC Backup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>如果问100个Oracle dba什么技能最重要，可能99个会回答是备份。很多junior dba会羡慕那些senior dba使用bbed修改数据块来恢复数据，但是如果做好备份，这些高级功能是根本派不上用场的。</p>
<p>Oracle自带的RMAN就是最好的备份恢复工具</p>
<p>使用RMAN前，首先要确保数据库运行在归档模式下（强烈建议所有的生产数据库都要开启归档）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; archive <span class="built_in">log</span> list;</span><br><span class="line">Database <span class="built_in">log</span> mode              No Archive Mode</span><br><span class="line">Automatic archival             Disabled</span><br><span class="line">Archive destination            USE_DB_RECOVERY_FILE_DEST</span><br><span class="line">Oldest online <span class="built_in">log</span> sequence     <span class="number">4</span></span><br><span class="line">Current <span class="built_in">log</span> sequence           <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>显然当前的数据库运行在非归档模式，需要手动重启数据库打开归档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[grid@<span class="number">12</span>c1 ~]$ srvctl stop database <span class="operator">-d</span> cdb                        <span class="comment">#关闭数据库</span></span><br><span class="line"></span><br><span class="line">[grid@<span class="number">12</span>c1 ~]$ srvctl start instance <span class="operator">-d</span> cdb -i cdb_1 -o mount     <span class="comment">#启动实例1到mount状态</span></span><br><span class="line"></span><br><span class="line">[oracle@<span class="number">12</span>c1 ~]$ sqlplus / as sysdba</span><br><span class="line"></span><br><span class="line">SQL*Plus: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> Production on Fri Mar <span class="number">4</span> <span class="number">09</span>:<span class="number">11</span>:<span class="number">08</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Connected to:</span><br><span class="line">Oracle Database <span class="number">12</span>c Enterprise Edition Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - <span class="number">64</span>bit Production</span><br><span class="line">With the Partitioning, Real Application Clusters, Automatic Storage Management, OLAP,</span><br><span class="line">Advanced Analytics and Real Application Testing options</span><br><span class="line"></span><br><span class="line">SQL&gt; alter database archivelog;                                   <span class="comment">#打开数据库归档</span></span><br><span class="line"></span><br><span class="line">Database altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; alter system <span class="built_in">set</span> <span class="built_in">log</span>_archive_dest_1=<span class="string">'location=+DATADG/CDB/archlog'</span> scope=both;    <span class="comment">#指定归档日志路径</span></span><br><span class="line"></span><br><span class="line">System altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; alter database open;                                         <span class="comment">#打开数据库</span></span><br><span class="line"></span><br><span class="line">Database altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; archive <span class="built_in">log</span> list;</span><br><span class="line">Database <span class="built_in">log</span> mode              Archive Mode</span><br><span class="line">Automatic archival             Enabled                            <span class="comment">#数据库已经运行在归档模式</span></span><br><span class="line">Archive destination            +DATADG/cdb/archlog</span><br><span class="line">Oldest online <span class="built_in">log</span> sequence     <span class="number">10</span></span><br><span class="line">Next <span class="built_in">log</span> sequence to archive   <span class="number">11</span></span><br><span class="line">Current <span class="built_in">log</span> sequence           <span class="number">11</span></span><br><span class="line"></span><br><span class="line">[grid@<span class="number">12</span>c2 ~]$ srvctl start instance <span class="operator">-d</span> cdb -i cdb_2 -o open      <span class="comment">#打开数据库实例2</span></span><br><span class="line"></span><br><span class="line">[oracle@<span class="number">12</span>c2 ~]$ sqlplus / as sysdba</span><br><span class="line"></span><br><span class="line">SQL*Plus: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> Production on Fri Mar <span class="number">4</span> <span class="number">09</span>:<span class="number">14</span>:<span class="number">39</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Connected to:</span><br><span class="line">Oracle Database <span class="number">12</span>c Enterprise Edition Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - <span class="number">64</span>bit Production</span><br><span class="line">With the Partitioning, Real Application Clusters, Automatic Storage Management, OLAP,</span><br><span class="line">Advanced Analytics and Real Application Testing options</span><br><span class="line"></span><br><span class="line">SQL&gt; archive <span class="built_in">log</span> list;</span><br><span class="line">Database <span class="built_in">log</span> mode              Archive Mode</span><br><span class="line">Automatic archival             Enabled                            <span class="comment">#同样也是运行在归档模式</span></span><br><span class="line">Archive destination            +DATADG/cdb/archlog                <span class="comment">#归档路径相同</span></span><br><span class="line">Oldest online <span class="built_in">log</span> sequence     <span class="number">18</span></span><br><span class="line">Next <span class="built_in">log</span> sequence to archive   <span class="number">19</span></span><br><span class="line">Current <span class="built_in">log</span> sequence           <span class="number">19</span></span><br></pre></td></tr></table></figure>
<p>12c中增加了CDB和PDB的概念，CDB相当于我们之前使用的数据库，PDB是可插拔的数据库。在数据库的备份过程中也和先前由了一些不同</p>
<h3 id="备份CDB数据库">备份CDB数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select con_id,dbid,guid,name,open_mode from v<span class="variable">$pdbs</span>;</span><br><span class="line"></span><br><span class="line">    CON_ID       DBID GUID                             NAME                           OPEN_MODE</span><br><span class="line">---------- ---------- -------------------------------- ------------------------------ ----------</span><br><span class="line">         <span class="number">2</span> <span class="number">2220247962</span> <span class="number">2</span>D1C0234F19A3237E053331E10ACBA01 PDB<span class="variable">$SEED</span>                       READ ONLY</span><br><span class="line">         <span class="number">3</span> <span class="number">3919665844</span> <span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5 PDB1                           MOUNTED</span><br><span class="line">         <span class="number">4</span> <span class="number">1716493435</span> <span class="number">2</span>D1C213A4CA74235E053331E10AC51F5 PDB2                           MOUNTED</span><br><span class="line"></span><br><span class="line">SQL&gt; alter pluggable database all open;                      <span class="comment">#默认情况下，pdb不会随着cdb打开而自动open，需要手动打开</span></span><br><span class="line"></span><br><span class="line">Pluggable database altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; select con_id,dbid,guid,name,open_mode from v<span class="variable">$pdbs</span>;</span><br><span class="line"></span><br><span class="line">    CON_ID       DBID GUID                             NAME                           OPEN_MODE</span><br><span class="line">---------- ---------- -------------------------------- ------------------------------ ----------</span><br><span class="line">         <span class="number">2</span> <span class="number">2220247962</span> <span class="number">2</span>D1C0234F19A3237E053331E10ACBA01 PDB<span class="variable">$SEED</span>                       READ ONLY</span><br><span class="line">         <span class="number">3</span> <span class="number">3919665844</span> <span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5 PDB1                           READ WRITE</span><br><span class="line">         <span class="number">4</span> <span class="number">1716493435</span> <span class="number">2</span>D1C213A4CA74235E053331E10AC51F5 PDB2                           READ WRITE</span><br><span class="line"></span><br><span class="line">[oracle@<span class="number">12</span>c1 ~]$ rman target /</span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">09</span>:<span class="number">33</span>:<span class="number">08</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>)</span><br><span class="line"></span><br><span class="line">RMAN&gt; backup filesperset=<span class="number">5</span> as compressed backupset database format <span class="string">'/tmp/full_db_%U'</span>;    <span class="comment">#手动备份数据库</span></span><br><span class="line"></span><br><span class="line">Starting backup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">42</span> instance=cdb_1 device <span class="built_in">type</span>=DISK</span><br><span class="line">channel ORA_DISK_1: starting compressed full datafile backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></span><br><span class="line">input datafile file number=<span class="number">00001</span> name=+DATADG/CDB/DATAFILE/system.<span class="number">258.905506407</span></span><br><span class="line">input datafile file number=<span class="number">00003</span> name=+DATADG/CDB/DATAFILE/sysaux.<span class="number">257.905506373</span></span><br><span class="line">input datafile file number=<span class="number">00004</span> name=+DATADG/CDB/DATAFILE/undotbs1.<span class="number">260.905506453</span></span><br><span class="line">input datafile file number=<span class="number">00008</span> name=+DATADG/CDB/DATAFILE/undotbs2.<span class="number">271.905506807</span></span><br><span class="line">input datafile file number=<span class="number">00006</span> name=+DATADG/CDB/DATAFILE/users.<span class="number">259.905506453</span></span><br><span class="line">channel ORA_DISK_1: starting piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">channel ORA_DISK_1: finished piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=/tmp/full_db_01qvkg0c_1_1 tag=TAG20160304T093404 comment=NONE</span><br><span class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">45</span></span><br><span class="line">channel ORA_DISK_1: starting compressed full datafile backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></span><br><span class="line">input datafile file number=<span class="number">00010</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/sysaux.<span class="number">278.905507007</span></span><br><span class="line">input datafile file number=<span class="number">00009</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/system.<span class="number">277.905507007</span></span><br><span class="line">input datafile file number=<span class="number">00011</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/users.<span class="number">280.905507027</span></span><br><span class="line">channel ORA_DISK_1: starting piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">channel ORA_DISK_1: finished piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=/tmp/full_db_02qvkg1p_1_1 tag=TAG20160304T093404 comment=NONE</span><br><span class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">25</span></span><br><span class="line">channel ORA_DISK_1: starting compressed full datafile backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></span><br><span class="line">input datafile file number=<span class="number">00013</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/sysaux.<span class="number">281.905507029</span></span><br><span class="line">input datafile file number=<span class="number">00012</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/system.<span class="number">282.905507029</span></span><br><span class="line">input datafile file number=<span class="number">00014</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/users.<span class="number">284.905507049</span></span><br><span class="line">channel ORA_DISK_1: starting piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">channel ORA_DISK_1: finished piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=/tmp/full_db_03qvkg2i_1_1 tag=TAG20160304T093404 comment=NONE</span><br><span class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">25</span></span><br><span class="line">channel ORA_DISK_1: starting compressed full datafile backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></span><br><span class="line">input datafile file number=<span class="number">00007</span> name=+DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/sysaux.<span class="number">268.905506511</span></span><br><span class="line">input datafile file number=<span class="number">00005</span> name=+DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/system.<span class="number">269.905506511</span></span><br><span class="line">channel ORA_DISK_1: starting piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">channel ORA_DISK_1: finished piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=/tmp/full_db_04qvkg3c_1_1 tag=TAG20160304T093404 comment=NONE</span><br><span class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">25</span></span><br><span class="line">Finished backup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">Starting Control File and SPFILE Autobackup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=+DATADG/CDB/AUTOBACKUP/<span class="number">2016</span>_03_04/s_905592965.<span class="number">286.905592965</span> comment=NONE</span><br><span class="line">Finished Control File and SPFILE Autobackup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; list backup summary;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">List of Backups</span><br><span class="line">===============</span><br><span class="line">Key     TY LV S Device Type Completion Time <span class="comment">#Pieces #Copies Compressed Tag</span></span><br><span class="line">------- -- -- - ----------- --------------- ------- ------- ---------- ---</span><br><span class="line"><span class="number">1</span>       B  F  A DISK        <span class="number">04</span>-MAR-<span class="number">16</span>       <span class="number">1</span>       <span class="number">1</span>       YES        TAG20160304T093404</span><br><span class="line"><span class="number">2</span>       B  F  A DISK        <span class="number">04</span>-MAR-<span class="number">16</span>       <span class="number">1</span>       <span class="number">1</span>       YES        TAG20160304T093404</span><br><span class="line"><span class="number">3</span>       B  F  A DISK        <span class="number">04</span>-MAR-<span class="number">16</span>       <span class="number">1</span>       <span class="number">1</span>       YES        TAG20160304T093404</span><br><span class="line"><span class="number">4</span>       B  F  A DISK        <span class="number">04</span>-MAR-<span class="number">16</span>       <span class="number">1</span>       <span class="number">1</span>       YES        TAG20160304T093404</span><br><span class="line"><span class="number">5</span>       B  F  A DISK        <span class="number">04</span>-MAR-<span class="number">16</span>       <span class="number">1</span>       <span class="number">1</span>       NO         TAG20160304T093605</span><br><span class="line"></span><br><span class="line">RMAN&gt; report schema;</span><br><span class="line"></span><br><span class="line">Report of database schema <span class="keyword">for</span> database with db_unique_name CDB</span><br><span class="line"></span><br><span class="line">List of Permanent Datafiles</span><br><span class="line">===========================</span><br><span class="line">File Size(MB) Tablespace           RB segs Datafile Name</span><br><span class="line">---- -------- -------------------- ------- ------------------------</span><br><span class="line"><span class="number">1</span>    <span class="number">800</span>      SYSTEM               YES     +DATADG/CDB/DATAFILE/system.<span class="number">258.905506407</span></span><br><span class="line"><span class="number">3</span>    <span class="number">760</span>      SYSAUX               NO      +DATADG/CDB/DATAFILE/sysaux.<span class="number">257.905506373</span></span><br><span class="line"><span class="number">4</span>    <span class="number">230</span>      UNDOTBS1             YES     +DATADG/CDB/DATAFILE/undotbs1.<span class="number">260.905506453</span></span><br><span class="line"><span class="number">5</span>    <span class="number">250</span>      PDB<span class="variable">$SEED</span>:SYSTEM      NO      +DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/system.<span class="number">269.905506511</span></span><br><span class="line"><span class="number">6</span>    <span class="number">5</span>        USERS                NO      +DATADG/CDB/DATAFILE/users.<span class="number">259.905506453</span></span><br><span class="line"><span class="number">7</span>    <span class="number">570</span>      PDB<span class="variable">$SEED</span>:SYSAUX      NO      +DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/sysaux.<span class="number">268.905506511</span></span><br><span class="line"><span class="number">8</span>    <span class="number">25</span>       UNDOTBS2             YES     +DATADG/CDB/DATAFILE/undotbs2.<span class="number">271.905506807</span></span><br><span class="line"><span class="number">9</span>    <span class="number">260</span>      PDB1:SYSTEM          NO      +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/system.<span class="number">277.905507007</span></span><br><span class="line"><span class="number">10</span>   <span class="number">580</span>      PDB1:SYSAUX          NO      +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/sysaux.<span class="number">278.905507007</span></span><br><span class="line"><span class="number">11</span>   <span class="number">5</span>        PDB1:USERS           NO      +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/users.<span class="number">280.905507027</span></span><br><span class="line"><span class="number">12</span>   <span class="number">250</span>      PDB2:SYSTEM          NO      +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/system.<span class="number">282.905507029</span></span><br><span class="line"><span class="number">13</span>   <span class="number">570</span>      PDB2:SYSAUX          NO      +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/sysaux.<span class="number">281.905507029</span></span><br><span class="line"><span class="number">14</span>   <span class="number">5</span>        PDB2:USERS           NO      +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/users.<span class="number">284.905507049</span></span><br><span class="line"></span><br><span class="line">List of Temporary Files</span><br><span class="line">=======================</span><br><span class="line">File Size(MB) Tablespace           Maxsize(MB) Tempfile Name</span><br><span class="line">---- -------- -------------------- ----------- --------------------</span><br><span class="line"><span class="number">1</span>    <span class="number">207</span>      TEMP                 <span class="number">32767</span>       +DATADG/CDB/TEMPFILE/temp.<span class="number">267.905506507</span></span><br><span class="line"><span class="number">2</span>    <span class="number">100</span>      PDB<span class="variable">$SEED</span>:TEMP        <span class="number">32767</span>       +DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/pdbseed_temp012016-<span class="number">03</span>-<span class="number">03</span>_09-<span class="number">35</span>-<span class="number">39</span>-am.dbf</span><br><span class="line"><span class="number">3</span>    <span class="number">20</span>       PDB1:TEMP            <span class="number">32767</span>       +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/TEMPFILE/temp.<span class="number">279.905507011</span></span><br><span class="line"><span class="number">4</span>    <span class="number">20</span>       PDB2:TEMP            <span class="number">32767</span>       +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/TEMPFILE/temp.<span class="number">283.905507033</span></span><br></pre></td></tr></table></figure>
<p>测试证明，当备份CDB时，会自动备份所有的PDB。</p>
<h3 id="RMAN通过CDB备份PDB">RMAN通过CDB备份PDB</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[oracle@<span class="number">12</span>c1 admin]$ rman target /</span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">09</span>:<span class="number">57</span>:<span class="number">06</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>)</span><br><span class="line"></span><br><span class="line">RMAN&gt; backup filesperset=<span class="number">5</span> as compressed backupset pluggable database PDB1 format <span class="string">'/tmp/pdb1_%U'</span>;    <span class="comment">#备份指定的PDB</span></span><br><span class="line"></span><br><span class="line">Starting backup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">50</span> instance=cdb_1 device <span class="built_in">type</span>=DISK</span><br><span class="line">channel ORA_DISK_1: starting compressed full datafile backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></span><br><span class="line">input datafile file number=<span class="number">00010</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/sysaux.<span class="number">278.905507007</span></span><br><span class="line">input datafile file number=<span class="number">00009</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/system.<span class="number">277.905507007</span></span><br><span class="line">input datafile file number=<span class="number">00011</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/users.<span class="number">280.905507027</span></span><br><span class="line">channel ORA_DISK_1: starting piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">channel ORA_DISK_1: finished piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=/tmp/pdb1_06qvkhd1_1_1 tag=TAG20160304T095753 comment=NONE</span><br><span class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">25</span></span><br><span class="line">Finished backup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">Starting Control File and SPFILE Autobackup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=+DATADG/CDB/AUTOBACKUP/<span class="number">2016</span>_03_04/s_905594299.<span class="number">287.905594299</span> comment=NONE</span><br><span class="line">Finished Control File and SPFILE Autobackup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br></pre></td></tr></table></figure>
<h3 id="模拟PDB全库恢复">模拟PDB全库恢复</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create table <span class="built_in">test</span> as select * from dba_objects;</span><br><span class="line"></span><br><span class="line">Table created.</span><br><span class="line"></span><br><span class="line">SQL&gt; select count(*) from <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">  COUNT(*)</span><br><span class="line">----------</span><br><span class="line">     <span class="number">90923</span></span><br><span class="line"></span><br><span class="line">SQL&gt; shutdown immediate;</span><br><span class="line">Pluggable Database closed.</span><br><span class="line"></span><br><span class="line">ASMCMD&gt; ls <span class="operator">-l</span>                                                   <span class="comment">#进入ASM删除数据文件</span></span><br><span class="line">Type      Redund  Striped  Time             Sys  Name</span><br><span class="line">DATAFILE  UNPROT  COARSE   MAR <span class="number">04</span> <span class="number">10</span>:<span class="number">00</span>:<span class="number">00</span>  Y    SYSAUX.<span class="number">278.905507007</span></span><br><span class="line">DATAFILE  UNPROT  COARSE   MAR <span class="number">04</span> <span class="number">10</span>:<span class="number">00</span>:<span class="number">00</span>  Y    SYSTEM.<span class="number">277.905507007</span></span><br><span class="line">DATAFILE  UNPROT  COARSE   MAR <span class="number">04</span> <span class="number">10</span>:<span class="number">00</span>:<span class="number">00</span>  Y    USERS.<span class="number">280.905507027</span></span><br><span class="line">ASMCMD&gt; rm <span class="operator">-f</span> *</span><br><span class="line"></span><br><span class="line">RMAN&gt; restore pluggable database PDB1;                         <span class="comment">#还原PDB</span></span><br><span class="line"></span><br><span class="line">Starting restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">42</span> instance=cdb_1 device <span class="built_in">type</span>=DISK</span><br><span class="line"></span><br><span class="line">channel ORA_DISK_1: starting datafile backup <span class="built_in">set</span> restore</span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) to restore from backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00009</span> to +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/system.<span class="number">277.905507007</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00010</span> to +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/sysaux.<span class="number">278.905507007</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00011</span> to +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/users.<span class="number">280.905507027</span></span><br><span class="line">channel ORA_DISK_1: reading from backup piece /tmp/pdb1_08qvki0j_1_1</span><br><span class="line">channel ORA_DISK_1: piece handle=/tmp/pdb1_08qvki0j_1_1 tag=TAG20160304T100818</span><br><span class="line">channel ORA_DISK_1: restored backup piece <span class="number">1</span></span><br><span class="line">channel ORA_DISK_1: restore complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">25</span></span><br><span class="line">Finished restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; recover pluggable database PDB1;                         <span class="comment">#恢复PDB</span></span><br><span class="line"></span><br><span class="line">Starting recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using channel ORA_DISK_1</span><br><span class="line"></span><br><span class="line">starting media recovery</span><br><span class="line">media recovery complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"></span><br><span class="line">Finished recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">SQL&gt; startup                                                   <span class="comment">#打开PDB检查数据</span></span><br><span class="line">Pluggable Database opened.</span><br><span class="line">SQL&gt; select count(*) from <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">  COUNT(*)</span><br><span class="line">----------</span><br><span class="line">     <span class="number">90923</span></span><br></pre></td></tr></table></figure>
<h3 id="模拟数据文件恢复">模拟数据文件恢复</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create table <span class="built_in">test</span> tablespace <span class="built_in">test</span> as select * from dba_objects;</span><br><span class="line"></span><br><span class="line">Table created.</span><br><span class="line"></span><br><span class="line">SQL&gt; select count(*) from <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">  COUNT(*)</span><br><span class="line">----------</span><br><span class="line">     <span class="number">90923</span></span><br><span class="line"></span><br><span class="line">SQL&gt; select file<span class="comment">#,name from v$datafile;</span></span><br><span class="line"></span><br><span class="line">     FILE<span class="comment"># NAME</span></span><br><span class="line">---------- --------------------------------------------------------------------------------</span><br><span class="line">         <span class="number">4</span> +DATADG/CDB/DATAFILE/undotbs1.<span class="number">260.905506453</span></span><br><span class="line">         <span class="number">9</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/system.<span class="number">278.905595177</span></span><br><span class="line">        <span class="number">10</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/sysaux.<span class="number">280.905595177</span></span><br><span class="line">        <span class="number">11</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/users.<span class="number">277.905595177</span></span><br><span class="line">        <span class="number">16</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line"></span><br><span class="line">SQL&gt; alter database datafile <span class="number">16</span> offline;</span><br><span class="line"></span><br><span class="line">Database altered.</span><br><span class="line">ASMCMD&gt; rm <span class="operator">-f</span> test.dbf               <span class="comment">#删除数据文件</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; list backup of datafile <span class="number">16</span>;                    <span class="comment">#查看数据文件的备份</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">List of Backup Sets</span><br><span class="line">===================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</span><br><span class="line">------- ---- -- ---------- ----------- ------------ ---------------</span><br><span class="line"><span class="number">11</span>      Full    <span class="number">159.29</span>M    DISK        <span class="number">00</span>:<span class="number">00</span>:<span class="number">22</span>     <span class="number">04</span>-MAR-<span class="number">16</span>      </span><br><span class="line">        BP Key: <span class="number">11</span>   Status: AVAILABLE  Compressed: YES  Tag: TAG20160304T103023</span><br><span class="line">        Piece Name: /tmp/pdb1_0bqvkj9v_1_1</span><br><span class="line">  List of Datafiles <span class="keyword">in</span> backup <span class="built_in">set</span> <span class="number">11</span></span><br><span class="line">  File LV Type Ckp SCN    Ckp Time  Name</span><br><span class="line">  ---- -- ---- ---------- --------- ----</span><br><span class="line">  <span class="number">16</span>      Full <span class="number">1950956</span>    <span class="number">04</span>-MAR-<span class="number">16</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oracle@<span class="number">12</span>c1 ~]$ rman target sys/oracle12@PDB1                  <span class="comment">#尝试通过rman连接pdb恢复，无法获得备份集状态</span></span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">11</span>:<span class="number">29</span>:<span class="number">04</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>, not open)</span><br><span class="line"></span><br><span class="line">RMAN&gt; restore datafile <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">Starting restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">11</span> instance=cdb_2 device <span class="built_in">type</span>=DISK</span><br><span class="line"></span><br><span class="line">channel ORA_DISK_1: starting datafile backup <span class="built_in">set</span> restore</span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) to restore from backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00016</span> to +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line">channel ORA_DISK_1: reading from backup piece /tmp/pdb1_0bqvkj9v_1_1</span><br><span class="line">channel ORA_DISK_1: ORA-<span class="number">19870</span>: error <span class="keyword">while</span> restoring backup piece /tmp/pdb1_0bqvkj9v_1_1</span><br><span class="line">ORA-<span class="number">19505</span>: failed to identify file <span class="string">"/tmp/pdb1_0bqvkj9v_1_1"</span></span><br><span class="line">ORA-<span class="number">27037</span>: unable to obtain file status</span><br><span class="line">Linux-x86_64 Error: <span class="number">2</span>: No such file or directory</span><br><span class="line">Additional information: <span class="number">3</span></span><br><span class="line"></span><br><span class="line">failover to previous backup</span><br><span class="line"></span><br><span class="line">creating datafile file number=<span class="number">16</span> name=+DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line">Finished restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[oracle@<span class="number">12</span>c1 ~]$ rman target /                     <span class="comment">#连接cdb恢复正常</span></span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">11</span>:<span class="number">29</span>:<span class="number">56</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>)</span><br><span class="line"></span><br><span class="line">RMAN&gt; restore datafile <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">Starting restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">24</span> instance=cdb_1 device <span class="built_in">type</span>=DISK</span><br><span class="line"></span><br><span class="line">channel ORA_DISK_1: starting datafile backup <span class="built_in">set</span> restore</span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) to restore from backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00016</span> to +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line">channel ORA_DISK_1: reading from backup piece /tmp/pdb1_0bqvkj9v_1_1</span><br><span class="line">channel ORA_DISK_1: piece handle=/tmp/pdb1_0bqvkj9v_1_1 tag=TAG20160304T103023</span><br><span class="line">channel ORA_DISK_1: restored backup piece <span class="number">1</span></span><br><span class="line">channel ORA_DISK_1: restore complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">03</span></span><br><span class="line">Finished restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; recover datafile <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">Starting recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using channel ORA_DISK_1</span><br><span class="line"></span><br><span class="line">starting media recovery</span><br><span class="line"></span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">19</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_19_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">20</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_20_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">21</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_21_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">12</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_12_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">13</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_13_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">2</span>_12_905506500.dbf thread=<span class="number">2</span> sequence=<span class="number">12</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">1</span>_19_905506500.dbf thread=<span class="number">1</span> sequence=<span class="number">19</span></span><br><span class="line">media recovery complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line">Finished recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br></pre></td></tr></table></figure>
<p>完成恢复后，可以online数据文件，检查之前创建的表是否已经恢复<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; alter database datafile <span class="number">16</span> online;</span><br><span class="line"></span><br><span class="line">Database altered.</span><br><span class="line"></span><br><span class="line">SQL&gt; select count(*) from <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">  COUNT(*)</span><br><span class="line">----------</span><br><span class="line">     <span class="number">90923</span></span><br></pre></td></tr></table></figure></p>
<p>之前的测试发现不能连接PDB直接恢复，怀疑备份时连接CDB备份有关。RMAN连接PDB直接备份<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[oracle@<span class="number">12</span>c1 ~]$ rman target sys/oracle12@PDB2</span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">14</span>:<span class="number">11</span>:<span class="number">27</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>)</span><br><span class="line"></span><br><span class="line">RMAN&gt; backup filesperset=<span class="number">6</span> as compressed backupset database format <span class="string">'/tmp/pdb2_%U'</span>;</span><br><span class="line"></span><br><span class="line">Starting backup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using channel ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: starting compressed full datafile backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></span><br><span class="line">input datafile file number=<span class="number">00013</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/sysaux.<span class="number">281.905507029</span></span><br><span class="line">input datafile file number=<span class="number">00012</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/system.<span class="number">282.905507029</span></span><br><span class="line">input datafile file number=<span class="number">00017</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/test.dbf</span><br><span class="line">input datafile file number=<span class="number">00014</span> name=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/users.<span class="number">284.905507049</span></span><br><span class="line">channel ORA_DISK_1: starting piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">channel ORA_DISK_1: finished piece <span class="number">1</span> at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=/tmp/pdb2_0dqvl0c6_1_1 tag=TAG20160304T141325 comment=NONE</span><br><span class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">25</span></span><br><span class="line">Finished backup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">Starting Control File and SPFILE Autobackup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">piece handle=+DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/AUTOBACKUP/<span class="number">2016</span>_03_04/s_905609631.<span class="number">303.905609633</span> comment=NONE</span><br><span class="line">Finished Control File and SPFILE Autobackup at <span class="number">04</span>-MAR-<span class="number">16</span></span><br></pre></td></tr></table></figure></p>
<p>存储表数据的数据文件offline，连接ASM删除对应的数据文件后，尝试RMAN连接PDB恢复</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[oracle@<span class="number">12</span>c2 tmp]$ rman target sys/oracle12@pdb2</span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">14</span>:<span class="number">32</span>:<span class="number">24</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>)</span><br><span class="line"></span><br><span class="line">RMAN&gt; restore datafile <span class="number">17</span>;                      <span class="comment">#可以正常还原/恢复数据文件</span></span><br><span class="line"></span><br><span class="line">Starting restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">261</span> instance=cdb_1 device <span class="built_in">type</span>=DISK</span><br><span class="line"></span><br><span class="line">channel ORA_DISK_1: starting datafile backup <span class="built_in">set</span> restore</span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) to restore from backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00017</span> to +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/test.dbf</span><br><span class="line">channel ORA_DISK_1: reading from backup piece /tmp/pdb2_0dqvl0c6_1_1</span><br><span class="line">channel ORA_DISK_1: piece handle=/tmp/pdb2_0dqvl0c6_1_1 tag=TAG20160304T141325</span><br><span class="line">channel ORA_DISK_1: restored backup piece <span class="number">1</span></span><br><span class="line">channel ORA_DISK_1: restore complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">03</span></span><br><span class="line">Finished restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; recover datafile <span class="number">17</span>;</span><br><span class="line"></span><br><span class="line">Starting recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using channel ORA_DISK_1</span><br><span class="line"></span><br><span class="line">starting media recovery</span><br><span class="line">media recovery complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"></span><br><span class="line">Finished recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; alter database datafile <span class="number">17</span> online;</span><br><span class="line"></span><br><span class="line">Statement processed</span><br><span class="line"></span><br><span class="line">RMAN&gt; sql <span class="string">'select count(*) from test'</span>;</span><br><span class="line"></span><br><span class="line">sql statement: select count(*) from <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; select count(*) from <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">  COUNT(*)</span><br><span class="line">----------</span><br><span class="line">     <span class="number">90927</span></span><br></pre></td></tr></table></figure>
<p>这次测试发现我明明在节点1备份的，但生成的备份集却在节点2上，检查tnsnames.ora文件，连接服务对应的server为SCAN地址，忽然想到之前的测试，通过CDB备份后，连接PDB恢复，不能发现备份集，也可能是这个原因。又重新测试了一遍，确实如此。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">[oracle@<span class="number">12</span>c1 admin]$ sqlplus sys/oracle12@pdb1 as sysdba</span><br><span class="line"></span><br><span class="line">SQL*Plus: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> Production on Fri Mar <span class="number">4</span> <span class="number">14</span>:<span class="number">40</span>:<span class="number">17</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle.  All rights reserved.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Connected to:</span><br><span class="line">Oracle Database <span class="number">12</span>c Enterprise Edition Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - <span class="number">64</span>bit Production</span><br><span class="line">With the Partitioning, Real Application Clusters, Automatic Storage Management, OLAP,</span><br><span class="line">Advanced Analytics and Real Application Testing options</span><br><span class="line"></span><br><span class="line">SQL&gt; <span class="built_in">exit</span></span><br><span class="line">Disconnected from Oracle Database <span class="number">12</span>c Enterprise Edition Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - <span class="number">64</span>bit Production</span><br><span class="line">With the Partitioning, Real Application Clusters, Automatic Storage Management, OLAP,</span><br><span class="line">Advanced Analytics and Real Application Testing options</span><br><span class="line">[oracle@<span class="number">12</span>c1 admin]$ rman target sys/oracle12@pdb1</span><br><span class="line"></span><br><span class="line">Recovery Manager: Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production on Fri Mar <span class="number">4</span> <span class="number">14</span>:<span class="number">40</span>:<span class="number">30</span> <span class="number">2016</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">1982</span>, <span class="number">2014</span>, Oracle and/or its affiliates.  All rights reserved.</span><br><span class="line"></span><br><span class="line">connected to target database: CDB (DBID=<span class="number">2022110018</span>)</span><br><span class="line"></span><br><span class="line">RMAN&gt; list backup of datafile <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">using target database control file instead of recovery catalog</span><br><span class="line"></span><br><span class="line">List of Backup Sets</span><br><span class="line">===================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</span><br><span class="line">------- ---- -- ---------- ----------- ------------ ---------------</span><br><span class="line"><span class="number">11</span>      Full    <span class="number">159.29</span>M    DISK        <span class="number">00</span>:<span class="number">00</span>:<span class="number">22</span>     <span class="number">04</span>-MAR-<span class="number">16</span>      </span><br><span class="line">        BP Key: <span class="number">11</span>   Status: AVAILABLE  Compressed: YES  Tag: TAG20160304T103023</span><br><span class="line">        Piece Name: /tmp/pdb1_0bqvkj9v_1_1</span><br><span class="line">  List of Datafiles <span class="keyword">in</span> backup <span class="built_in">set</span> <span class="number">11</span></span><br><span class="line">  File LV Type Ckp SCN    Ckp Time  Name</span><br><span class="line">  ---- -- ---- ---------- --------- ----</span><br><span class="line">  <span class="number">16</span>      Full <span class="number">1950956</span>    <span class="number">04</span>-MAR-<span class="number">16</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line"></span><br><span class="line">RMAN&gt; alter database datafile <span class="number">16</span> offline;</span><br><span class="line"></span><br><span class="line">Statement processed</span><br><span class="line"></span><br><span class="line">RMAN&gt; restore datafile <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">Starting restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">allocated channel: ORA_DISK_1</span><br><span class="line">channel ORA_DISK_1: SID=<span class="number">376</span> instance=cdb_1 device <span class="built_in">type</span>=DISK</span><br><span class="line"></span><br><span class="line">channel ORA_DISK_1: starting datafile backup <span class="built_in">set</span> restore</span><br><span class="line">channel ORA_DISK_1: specifying datafile(s) to restore from backup <span class="built_in">set</span></span><br><span class="line">channel ORA_DISK_1: restoring datafile <span class="number">00016</span> to +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/test.dbf</span><br><span class="line">channel ORA_DISK_1: reading from backup piece /tmp/pdb1_0bqvkj9v_1_1</span><br><span class="line">channel ORA_DISK_1: piece handle=/tmp/pdb1_0bqvkj9v_1_1 tag=TAG20160304T103023</span><br><span class="line">channel ORA_DISK_1: restored backup piece <span class="number">1</span></span><br><span class="line">channel ORA_DISK_1: restore complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">03</span></span><br><span class="line">Finished restore at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; recover datafile <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">Starting recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line">using channel ORA_DISK_1</span><br><span class="line"></span><br><span class="line">starting media recovery</span><br><span class="line"></span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">19</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_19_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">20</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_20_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">21</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_21_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">1</span> with sequence <span class="number">22</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">1</span>_22_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">12</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_12_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">13</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_13_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">14</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_14_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">15</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_15_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread <span class="number">2</span> with sequence <span class="number">16</span> is already on disk as file +DATADG/cdb/archlog/<span class="number">2</span>_16_905506500.dbf</span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">2</span>_12_905506500.dbf thread=<span class="number">2</span> sequence=<span class="number">12</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">1</span>_19_905506500.dbf thread=<span class="number">1</span> sequence=<span class="number">19</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">1</span>_20_905506500.dbf thread=<span class="number">1</span> sequence=<span class="number">20</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">2</span>_13_905506500.dbf thread=<span class="number">2</span> sequence=<span class="number">13</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">1</span>_21_905506500.dbf thread=<span class="number">1</span> sequence=<span class="number">21</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">2</span>_14_905506500.dbf thread=<span class="number">2</span> sequence=<span class="number">14</span></span><br><span class="line">archived <span class="built_in">log</span> file name=+DATADG/cdb/archlog/<span class="number">2</span>_15_905506500.dbf thread=<span class="number">2</span> sequence=<span class="number">15</span></span><br><span class="line">media recovery complete, elapsed time: <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span></span><br><span class="line">Finished recover at <span class="number">04</span>-MAR-<span class="number">16</span></span><br><span class="line"></span><br><span class="line">RMAN&gt; alter database datafile <span class="number">16</span> online;</span><br><span class="line"></span><br><span class="line">Statement processed</span><br><span class="line"></span><br><span class="line">RMAN&gt; select count(*) from <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">  COUNT(*)</span><br><span class="line">----------</span><br><span class="line">     <span class="number">90923</span></span><br></pre></td></tr></table></figure>
<p>备份的内容实在太多，这次就先测试到这吧。。。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/04/Oracle 12c RAC Backup/" data-id="cilbwmlwh000i2wianu2zlypq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Oracle 12c RAC installation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/03/Oracle 12c RAC installation/" class="article-date">
  <time datetime="2016-03-03T02:22:53.000Z" itemprop="datePublished">2016-03-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Oracle-12c/">Oracle 12c</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/03/Oracle 12c RAC installation/">Oracle 12c RAC Installation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>再次来到福州出差已经是春暖花开，坐在阳光明媚的办公室里写东西可比年前冻手冻脚的时候好多了。最近经常被问一些oracle的问题，但说实话，距上次动oracle已经差不多一年了，好多东西有印象但就是不知道具体怎么做。哎…选择计算机这个行业就是个错误，知识日新月异，唯有不断学习。<br>趁着出差的时间，准备装套12c学习下，oracle都开始对自己的数据库以cloud命名了，我们也要抓紧时间跟上啊</p>
<p>11G的RAC装了不下10遍，在网上搜了一下12C的安装步骤便开始动手，以下我将选取一下和之前安装的不同处截图说明</p>
<h2 id="Grid_安装">Grid 安装</h2><p>私有网络除了作为之前的集群心跳，还可以作为ASM的网络<br><img src="/images/oracle12c/priv.png" alt="priv"><br>12C支持Flex ASM，可以实现数据库实例与ASM实例不在同一台主机<br><img src="/images/oracle12c/asm.png" alt="asm"><br>故障隔离支持，IPMI（Intelligent Platform Management Interface），在11gR2开始支持，但在之前的安装过程中没有发现这个选项<br><img src="/images/oracle12c/ipmi.png" alt="ipmi"><br>12C grid安装支持自动执行安装后的root.sh脚本，但我在安装的时候一直提示root密码错误，没办法只能手动执行<br><img src="/images/oracle12c/root.png" alt="root"></p>
<h2 id="Database_安装">Database 安装</h2><p>database的安装一直都是比较简单，变化的地方也比较少，只是在数据库操作系统组上新增了一些选项<br><img src="/images/oracle12c/group.png" alt="group"></p>
<h2 id="dbca_建库">dbca 建库</h2><p>支持使用默认选项创建数据库<br><img src="/images/oracle12c/dbca.png" alt="dbca"><br>12c的c代表cloud，在这个版本中，oracle做出了很大的变化，引入了CDB（Container Database）和PDB（Pluggable Database）的概念<br><img src="/images/oracle12c/cdb.png" alt="cdb"><br>指定服务器池<br><img src="/images/oracle12c/pool.png" alt="pool"></p>
<p>之后就可以一路next创建好自己的12c数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">SQL&gt; select * from v<span class="variable">$version</span>;</span><br><span class="line"></span><br><span class="line">BANNER                                                                               CON_ID</span><br><span class="line">-------------------------------------------------------------------------------- ----------</span><br><span class="line">Oracle Database <span class="number">12</span>c Enterprise Edition Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - <span class="number">64</span>bit Production              <span class="number">0</span></span><br><span class="line">PL/SQL Release <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production                                                    <span class="number">0</span></span><br><span class="line">CORE    <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span>      Production                                                        <span class="number">0</span></span><br><span class="line">TNS <span class="keyword">for</span> Linux: Version <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production                                            <span class="number">0</span></span><br><span class="line">NLSRTL Version <span class="number">12.1</span>.<span class="number">0.2</span>.<span class="number">0</span> - Production                                                    <span class="number">0</span></span><br><span class="line"></span><br><span class="line">SQL&gt; select con_id,dbid,guid,name,open_mode from v<span class="variable">$pdbs</span>;</span><br><span class="line"></span><br><span class="line">    CON_ID       DBID GUID                             NAME                           OPEN_MODE</span><br><span class="line">---------- ---------- -------------------------------- ------------------------------ ----------</span><br><span class="line">         <span class="number">2</span> <span class="number">2220247962</span> <span class="number">2</span>D1C0234F19A3237E053331E10ACBA01 PDB<span class="variable">$SEED</span>                       READ ONLY</span><br><span class="line">         <span class="number">3</span> <span class="number">3919665844</span> <span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5 PDB1                           MOUNTED</span><br><span class="line">         <span class="number">4</span> <span class="number">1716493435</span> <span class="number">2</span>D1C213A4CA74235E053331E10AC51F5 PDB2                           MOUNTED</span><br><span class="line"></span><br><span class="line">SQL&gt; select file<span class="comment">#,name from v$datafile;</span></span><br><span class="line"></span><br><span class="line">     FILE<span class="comment"># NAME</span></span><br><span class="line">---------- --------------------------------------------------------------------------------</span><br><span class="line">         <span class="number">1</span> +DATADG/CDB/DATAFILE/system.<span class="number">258.905506407</span></span><br><span class="line">         <span class="number">3</span> +DATADG/CDB/DATAFILE/sysaux.<span class="number">257.905506373</span></span><br><span class="line">         <span class="number">4</span> +DATADG/CDB/DATAFILE/undotbs1.<span class="number">260.905506453</span></span><br><span class="line">         <span class="number">5</span> +DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/system.<span class="number">269.905506511</span></span><br><span class="line">         <span class="number">6</span> +DATADG/CDB/DATAFILE/users.<span class="number">259.905506453</span></span><br><span class="line">         <span class="number">7</span> +DATADG/CDB/FD9AC20F64D244D7E043B6A9E80A2F2F/DATAFILE/sysaux.<span class="number">268.905506511</span></span><br><span class="line">         <span class="number">8</span> +DATADG/CDB/DATAFILE/undotbs2.<span class="number">271.905506807</span></span><br><span class="line">         <span class="number">9</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/system.<span class="number">277.905507007</span></span><br><span class="line">        <span class="number">10</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/sysaux.<span class="number">278.905507007</span></span><br><span class="line">        <span class="number">11</span> +DATADG/CDB/<span class="number">2</span>D1C1FD3772740DEE053331E10ACF3E5/DATAFILE/users.<span class="number">280.905507027</span></span><br><span class="line">        <span class="number">12</span> +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/system.<span class="number">282.905507029</span></span><br><span class="line">        <span class="number">13</span> +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/sysaux.<span class="number">281.905507029</span></span><br><span class="line">        <span class="number">14</span> +DATADG/CDB/<span class="number">2</span>D1C213A4CA74235E053331E10AC51F5/DATAFILE/users.<span class="number">284.905507049</span></span><br><span class="line"></span><br><span class="line"><span class="number">13</span> rows selected.</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/03/Oracle 12c RAC installation/" data-id="cilbmymrc00022wias6ks5hx0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vRealize Automation &amp; Operations" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/29/vRealize Automation & Operations/" class="article-date">
  <time datetime="2016-01-29T06:12:53.000Z" itemprop="datePublished">2016-01-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/VMware/">VMware</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/29/vRealize Automation & Operations/">vRealize Automation &amp; Operations Manager</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>搭建完vsphere基础环境后，决定测试下VMware云管理平台产品vRealize Automation，结果却掉入到一个深不见底的坑里，断断续续搞了有一周，每次快要爬到地面，却又重重的摔了下去。还好没有放弃，最终还是搞出来了。记录下整个过程，希望能对后来人有帮助。</p>
<h2 id="vRealize_Automation">vRealize Automation</h2><p>测试的版本是vRealize Automation 7.0</p>
<h3 id="安装前准备">安装前准备</h3><p>需要配置Windows Active Directory域，域名为mycluster.local<br>配置DNS和NTP服务<br>具体步骤不介绍了，网上有详细的步骤，我也是靠度娘的。</p>
<h3 id="部署vRealize_Automation_Appliance">部署vRealize Automation Appliance</h3><p>部署OVF模板<br><img src="/images/vautomation/vra-1.png" alt="vra-1"><br>查看详细信息<br><img src="/images/vautomation/vra-2.png" alt="vra-2"><br>接受许可协议<br><img src="/images/vautomation/vra-3.png" alt="vra-3"><br>选择名称和文件夹<br><img src="/images/vautomation/vra-4.png" alt="vra-4"><br>选择存储<br><img src="/images/vautomation/vra-5.png" alt="vra-5"><br>设置网络<br><img src="/images/vautomation/vra-6.png" alt="vra-6"><br>自定义模板<br><img src="/images/vautomation/vra-7.png" alt="vra-7"><br>部署完成<br><img src="/images/vautomation/vra-8.png" alt="vra-8"></p>
<h3 id="部署IaaS服务器">部署IaaS服务器</h3><p>安装Windows 2012操作系统，关闭本地防火墙，加入mycluster.local域，并安装.NET 4.5.2和JDK软件。<br>设置Java系统变量，包括：JAVA_HOME、CLASS_PATH、PATH<br>为IaaS服务器添加角色和功能，安装Microsoft SQL Server 2012数据库</p>
<h3 id="通过部署向导配置vRealize_Automation_Appliance">通过部署向导配置vRealize Automation Appliance</h3><p>使用vRealize Automation配置向导<br><img src="/images/vautomation/vra-9.png" alt="vra-9"><br>接受End User License Agreement<br><img src="/images/vautomation/vra-10.png" alt="vra-10"><br>部署类型选择最小安装，安装要求<br><img src="/images/vautomation/vra-11.png" alt="vra-11"><br>点击“run”执行安装检查<br><img src="/images/vautomation/vra-12.png" alt="vra-12"><br>指定Host地址<br><img src="/images/vautomation/vra-13.png" alt="vra-13"><br>设置密码<br><img src="/images/vautomation/vra-14.png" alt="vra-14"><br>设置IaaS主机<br><img src="/images/vautomation/vra-15.png" alt="vra-15"><br>设置Microsoft SQL Server数据库<br><img src="/images/vautomation/vra-16.png" alt="vra-16"><br>添加DEM<br><img src="/images/vautomation/vra-17.png" alt="vra-17"><br>设置Agent<br><img src="/images/vautomation/vra-18.png" alt="vra-18"><br>创建证书<br><img src="/images/vautomation/vra-19.png" alt="vra-19"><br>Web证书<br><img src="/images/vautomation/vra-20.png" alt="vra-20"><br>管理服务证书<br><img src="/images/vautomation/vra-21.png" alt="vra-21"><br>验证配置<br><img src="/images/vautomation/vra-22.png" alt="vra-22"><br>创建快照<br><img src="/images/vautomation/vra-23.png" alt="vra-23"><br>开始安装<br><img src="/images/vautomation/vra-24.png" alt="vra-24"><br>完成安装<br><img src="/images/vautomation/vra-25.png" alt="vra-25"><br>输入License，网上找到一个临时的<br><img src="/images/vautomation/vra-26.png" alt="vra-26"><br>创建配置管理员<br><img src="/images/vautomation/vra-27.png" alt="vra-27"><br>完成部署<br><img src="/images/vautomation/vra-28.png" alt="vra-28"><br>看到Successfully小兴奋了一下，谁知道头疼的还在后边。</p>
<h3 id="vRealize_Automation基本配置和管理">vRealize Automation基本配置和管理</h3><p>使用浏览器访问<a href="https://vra.myscluster.local/vcac，通过configurationadmin账户登录。" target="_blank" rel="external">https://vra.myscluster.local/vcac，通过configurationadmin账户登录。</a><br>打开管理-&gt;身份目录管理-&gt;目录，点击“添加目录”<br><img src="/images/vautomation/vra-29.png" alt="vra-29"><br>输入“目录名称”、“基本DN”、“绑定DN”、“绑定DN密码”，点击“保存并执行下一步”<br><img src="/images/vautomation/vra-30.png" alt="vra-30"><br><img src="/images/vautomation/vra-31.png" alt="vra-31"><br>确认域信息正确，点击“下一步”<br><img src="/images/vautomation/vra-32.png" alt="vra-32"><br>添加Manager中的自定义属性为“Manager”，点击“下一步”<br><img src="/images/vautomation/vra-33.png" alt="vra-33"><br>选择要同步的组，点击“下一步”<br><img src="/images/vautomation/vra-34.png" alt="vra-34"><br>选择希望同步的用户，点击“下一步”<br><img src="/images/vautomation/vra-35.png" alt="vra-35"><br>确认配置完成和同步状态<br><img src="/images/vautomation/vra-36.png" alt="vra-36"></p>
<p>打开管理-&gt;用户和组-&gt;目录用户和组，搜索框内输入“administrator”<br><img src="/images/vautomation/vra-37.png" alt="vra-37"><br>向此用户添加角色，点击“完成”<br><img src="/images/vautomation/vra-38.png" alt="vra-38"></p>
<p>注销当前用户，切换到vsphere.local域，使用administrator用户登录<br><img src="/images/vautomation/vra-39.png" alt="vra-39"><br>进入管理-&gt;租户，打开“vsphere.local”，在IaaS管理员中添加“administrator”用户，点击“完成”<br><img src="/images/vautomation/vra-40.png" alt="vra-40"></p>
<p>使用administrator用户登录到“mycluster.local”域<br>进入基础架构-&gt;端点-&gt;端点，点击New在下拉菜单选择Orchestrator-&gt;vRealize Orchestrator<br><img src="/images/vautomation/vra-41.png" alt="vra-41"><br>输入Orchestrator配置，点击OK完成配置<br><img src="/images/vautomation/vra-42.png" alt="vra-42"><br>进入基础架构-&gt;端点-&gt;端点，点击New在下拉菜单选择Virtual-&gt;vSphere(vCenter)<br><img src="/images/vautomation/vra-43.png" alt="vra-43"><br>输入vCenter配置，点击OK完成配置<br><img src="/images/vautomation/vra-44.png" alt="vra-44"><br>进入基础架构-&gt;计算资源-&gt;计算资源，在集群展开菜单中选择“Data Collection”<br><img src="/images/vautomation/vra-45.png" alt="vra-45"><br>点击Inventory中的Request Now按键，直到状态变为Succeeded<br><img src="/images/vautomation/vra-46.png" alt="vra-46"><br>进入基础架构-&gt;端点-&gt;架构组，点击New创建Fabric Groups<br><img src="/images/vautomation/vra-47.png" alt="vra-47"><br>进入基础架构-&gt;管理-&gt;计算机前缀，点击New创建计算机前缀<br><img src="/images/vautomation/vra-48.png" alt="vra-48"><br>进入管理-&gt;用户和组-&gt;业务组，点击新建<br><img src="/images/vautomation/vra-49.png" alt="vra-49"><br>添加业务组成员<br><img src="/images/vautomation/vra-50.png" alt="vra-50"><br>基础架构选择“Dev-”作为默认计算机前缀<br><img src="/images/vautomation/vra-51.png" alt="vra-51"></p>
<p>进入基础架构-&gt;预留-&gt;网络配置文件，点击New按钮<br><img src="/images/vautomation/vra-52.png" alt="vra-52"><br>配置IP地址池<br><img src="/images/vautomation/vra-53.png" alt="vra-53"></p>
<p>进入基础架构-&gt;预留-&gt;预留，点击New按钮<br><img src="/images/vautomation/vra-54.png" alt="vra-54"><br>配置保留计算资源<br><img src="/images/vautomation/vra-55.png" alt="vra-55"><br>配置保留网络资源<br><img src="/images/vautomation/vra-56.png" alt="vra-56"></p>
<p>进入设计-&gt;蓝图，点击新建按钮<br><img src="/images/vautomation/vra-57.png" alt="vra-57"><br>点击计算资源，鼠标左键拖拽vSphere Machine至右侧画布中<br><img src="/images/vautomation/vra-58.png" alt="vra-58"><br>填写构建信息<br><img src="/images/vautomation/vra-59.png" alt="vra-59"><br>点击网络与安全，鼠标左键拖拽现有网络至右侧画布中，现有网络中选择“Default External Network Profile”<br><img src="/images/vautomation/vra-60.png" alt="vra-60"><br>选中蓝图，点击发布<br><img src="/images/vautomation/vra-61.png" alt="vra-61"></p>
<p>进入管理-&gt;目录管理-&gt;服务，点击新建按钮<br><img src="/images/vautomation/vra-62.png" alt="vra-62"><br>进入管理-&gt;目录管理-&gt;授权，点击新建按钮<br><img src="/images/vautomation/vra-63.png" alt="vra-63"><br>创建授权<br><img src="/images/vautomation/vra-64.png" alt="vra-64"><br>进入管理-&gt;目录管理-&gt;目录项，选中蓝图，点击配置<br><img src="/images/vautomation/vra-65.png" alt="vra-65"><br>配置目录项<br><img src="/images/vautomation/vra-66.png" alt="vra-66"><br>进入目录，选到蓝图，点击请求<br><img src="/images/vautomation/vra-67.png" alt="vra-67"><br>点击提交<br><img src="/images/vautomation/vra-68.png" alt="vra-68"><br>通过请求页面查看部署状态<br><img src="/images/vautomation/vra-69.png" alt="vra-69"><br>部署完成后，进入项目页面查看已部署服务<br><img src="/images/vautomation/vra-70.png" alt="vra-70"><br>至此，vRealize Automation基本配置已经完成。</p>
<p>进入管理-&gt;审批管理，点击新建，选择服务目录-目录项请求<br><img src="/images/vautomation/vra-71.png" alt="vra-71"><br>新建批准策略<br><img src="/images/vautomation/vra-72.png" alt="vra-72"><br>新建级别<br><img src="/images/vautomation/vra-73.png" alt="vra-73"><br>进入管理-&gt;目录管理-&gt;授权，选择“Development”授权，点击编辑<br><img src="/images/vautomation/vra-74.png" alt="vra-74"><br>在授权项目中选择CentOS6.5，选择修改策略<br><img src="/images/vautomation/vra-75.png" alt="vra-75"><br>应用策略<br><img src="/images/vautomation/vra-76.png" alt="vra-76"><br>进入目录页，点击请求；进入请求页，查看状态为待审批<br><img src="/images/vautomation/vra-77.png" alt="vra-77"><br>进入收件箱-&gt;批准，选中待审批项目，点击查看详细信息<br><img src="/images/vautomation/vra-78.png" alt="vra-78"><br>输入Approval理由，点击批准<br><img src="/images/vautomation/vra-79.png" alt="vra-79"><br>再次切换到请求页，查看状态为正在进行<br><img src="/images/vautomation/vra-80.png" alt="vra-80"></p>
<h2 id="vRealize_Operations_Manager">vRealize Operations Manager</h2><p>这是vSphere中运维监控的组件，目前已经可以和vsphere打包一起买，简称vSOM</p>
<h3 id="vRealize_Operations_Manager部署">vRealize Operations Manager部署</h3><p>部署OVF模板<br><img src="/images/voperation/vom-1.png" alt="vom-1"><br>查看详细信息<br><img src="/images/voperation/vom-2.png" alt="vom-2"><br>接受许可协议<br><img src="/images/voperation/vom-3.png" alt="vom-3"><br>选择名称和文件夹<br><img src="/images/voperation/vom-4.png" alt="vom-4"><br>选择配置<br><img src="/images/voperation/vom-5.png" alt="vom-5"><br>选择存储<br><img src="/images/voperation/vom-6.png" alt="vom-6"><br>设置网络<br><img src="/images/voperation/vom-7.png" alt="vom-7"><br>自定义模板<br><img src="/images/voperation/vom-8.png" alt="vom-8"><br>部署完成<br><img src="/images/voperation/vom-9.png" alt="vom-9"></p>
<h3 id="vRealize_Operations_Manager初始配置">vRealize Operations Manager初始配置</h3><p>选择新安装<br><img src="/images/voperation/vom-10.png" alt="vom-10"><br>新建集群<br><img src="/images/voperation/vom-11.png" alt="vom-11"><br>设置管理员账号和密码<br><img src="/images/voperation/vom-12.png" alt="vom-12"><br>选择证书<br><img src="/images/voperation/vom-13.png" alt="vom-13"><br>部署设置<br><img src="/images/voperation/vom-14.png" alt="vom-14"><br>后续步骤<br><img src="/images/voperation/vom-15.png" alt="vom-15"><br>首次登录<br><img src="/images/voperation/vom-16.png" alt="vom-16"><br>接受EULA<br><img src="/images/voperation/vom-17.png" alt="vom-17"><br>输入产品许可证密钥<br><img src="/images/voperation/vom-18.png" alt="vom-18"><br>客户体验计划<br><img src="/images/voperation/vom-19.png" alt="vom-19"><br>完成配置<br><img src="/images/voperation/vom-20.png" alt="vom-20"></p>
<p>配置管理解决方案<br><img src="/images/voperation/vom-21.png" alt="vom-21"><br>定义监控目标<br><img src="/images/voperation/vom-22.png" alt="vom-22"><br>配置完成<br><img src="/images/voperation/vom-23.png" alt="vom-23"></p>
<h3 id="vRealize_Automation集成Operations_Manager">vRealize Automation集成Operations Manager</h3><p>进入管理-&gt;回收-&gt;衡量指标提供程序，选择vRealize Operations Manager端点<br><img src="/images/voperation/vom-24.png" alt="vom-24"><br>测试连接成功后，点击保存<br><img src="/images/voperation/vom-25.png" alt="vom-25"><br>点击确定，信任证书<br><img src="/images/voperation/vom-26.png" alt="vom-26"><br>进入管理-&gt;回收-&gt;租户计算机，可以看到运行状态显示<br><img src="/images/voperation/vom-27.png" alt="vom-27"></p>
<p>这个主题的内容终于完成了，成功的通过vRealize Automation完成虚拟机部署，并结合Operations Manager进行虚拟化平台监控。更详细的内容我也在学习中，以后慢慢来补充。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/29/vRealize Automation & Operations/" data-id="cijzalv540004y0iaz3rzp725" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vsphere data protection &amp; replication" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/26/vsphere data protection & replication/" class="article-date">
  <time datetime="2016-01-26T08:15:53.000Z" itemprop="datePublished">2016-01-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/VMware/">VMware</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/26/vsphere data protection & replication/">vSphere Data Protection &amp; Replication</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>因为没有单独购买备份软件和带库，使用vSphere Data Protection将虚拟机备份到共享存储；因为用户这里有备份站点，使用vSphere Replication将虚拟机同步到备站</p>
<h2 id="vSphere_Data_Protection虚拟机备份">vSphere Data Protection虚拟机备份</h2><p>部署OVF模板<br><img src="/images/vdataprotection/vdp-1.png" alt="vdp-1"><br>查看详细信息<br><img src="/images/vdataprotection/vdp-2.png" alt="vdp-2"><br>接受许可协议<br><img src="/images/vdataprotection/vdp-3.png" alt="vdp-3"><br>选择名称和文件夹<br><img src="/images/vdataprotection/vdp-4.png" alt="vdp-4"><br>选择存储器<br><img src="/images/vdataprotection/vdp-5.png" alt="vdp-5"><br>设置网络<br><img src="/images/vdataprotection/vdp-6.png" alt="vdp-6"><br>配置网络参数<br><img src="/images/vdataprotection/vdp-7.png" alt="vdp-7"><br>完成部署<br><img src="/images/vdataprotection/vdp-8.png" alt="vdp-8"><br>开始初始配置<br><img src="/images/vdataprotection/vdp-9.png" alt="vdp-9"><br>网络设置<br><img src="/images/vdataprotection/vdp-10.png" alt="vdp-10"><br>选择时区<br><img src="/images/vdataprotection/vdp-11.png" alt="vdp-11"><br>设置密码<br><img src="/images/vdataprotection/vdp-12.png" alt="vdp-12"><br>vCenter注册<br><img src="/images/vdataprotection/vdp-13.png" alt="vdp-13"><br>创建存储<br><img src="/images/vdataprotection/vdp-14.png" alt="vdp-14"><br>设备分配<br><img src="/images/vdataprotection/vdp-15.png" alt="vdp-15"><br>CPU和内存<br><img src="/images/vdataprotection/vdp-16.png" alt="vdp-16"><br>产品改进<br><img src="/images/vdataprotection/vdp-17.png" alt="vdp-17"><br>完成配置<br><img src="/images/vdataprotection/vdp-18.png" alt="vdp-18"><br>重启vCenter后，在web client已能够看到VDP的应用，选择“连接”<br><img src="/images/vdataprotection/vdp-19.png" alt="vdp-19"><br>创建备份作业<br><img src="/images/vdataprotection/vdp-20.png" alt="vdp-20"><br>作业类型<br><img src="/images/vdataprotection/vdp-21.png" alt="vdp-21"><br>数据类型<br><img src="/images/vdataprotection/vdp-22.png" alt="vdp-22"><br>选择备份源<br><img src="/images/vdataprotection/vdp-23.png" alt="vdp-23"><br>备份计划<br><img src="/images/vdataprotection/vdp-24.png" alt="vdp-24"><br>保留计划<br><img src="/images/vdataprotection/vdp-25.png" alt="vdp-25"><br>作业名称<br><img src="/images/vdataprotection/vdp-26.png" alt="vdp-26"><br>完成配置<br><img src="/images/vdataprotection/vdp-27.png" alt="vdp-27"></p>
<h2 id="vSphere_Replication虚拟机复制">vSphere Replication虚拟机复制</h2><p>部署OVF模板<br><img src="/images/vreplication/vrep-1.png" alt="vrep-1"><br>查看详细信息<br><img src="/images/vreplication/vrep-2.png" alt="vrep-2"><br>接受许可协议<br><img src="/images/vreplication/vrep-3.png" alt="vrep-3"><br>选择名称和文件夹<br><img src="/images/vreplication/vrep-4.png" alt="vrep-4"><br>选择配置<br><img src="/images/vreplication/vrep-5.png" alt="vrep-5"><br>选择存储<br><img src="/images/vreplication/vrep-6.png" alt="vrep-6"><br>设置网络<br><img src="/images/vreplication/vrep-7.png" alt="vrep-7"><br>自定义模板<br><img src="/images/vreplication/vrep-8.png" alt="vrep-8"><br>vService绑定<br><img src="/images/vreplication/vrep-9.png" alt="vrep-9"><br>配置完成<br><img src="/images/vreplication/vrep-10.png" alt="vrep-10"><br>连接目标站点<br><img src="/images/vreplication/vrep-11.png" alt="vrep-11"><br>配置复制<br><img src="/images/vreplication/vrep-12.png" alt="vrep-12"><br>选择目标站点<br><img src="/images/vreplication/vrep-13.png" alt="vrep-13"><br>选择复制服务器<br><img src="/images/vreplication/vrep-14.png" alt="vrep-14"><br>选择目标位置<br><img src="/images/vreplication/vrep-15.png" alt="vrep-15"><br>复制选项<br><img src="/images/vreplication/vrep-16.png" alt="vrep-16"><br>恢复设置<br><img src="/images/vreplication/vrep-17.png" alt="vrep-17"><br>配置完成<br><img src="/images/vreplication/vrep-18.png" alt="vrep-18"><br>同步成功后，可以在目标站点执行恢复。<br><img src="/images/vreplication/vrep-19.png" alt="vrep-19"><br>恢复到的文件夹<br><img src="/images/vreplication/vrep-20.png" alt="vrep-20"><br>恢复到的资源池<br><img src="/images/vreplication/vrep-21.png" alt="vrep-21"><br>完成恢复<br><img src="/images/vreplication/vrep-22.png" alt="vrep-22"><br>vSphere Replication可以方便的通过以太网进行虚拟机的复制，但在目标端恢复虚拟机后，先前的同步不能继续执行。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/26/vsphere data protection & replication/" data-id="cijv4lxn7000nd8iakp39dooc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Create vMachine &amp; Profile" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/24/Create vMachine & Profile/" class="article-date">
  <time datetime="2016-01-24T08:50:53.000Z" itemprop="datePublished">2016-01-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/VMware/">VMware</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/24/Create vMachine & Profile/">Create vMachine &amp; Profile</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这周全国遇上了几十年一遇的寒潮，广州都下雪了，福州也没好到哪去，最低温度到了零下。听着屋外的大风，坐在办公室里发抖，脚则冻成了冰块。最近仍然在折腾虚拟化，希望能多写几篇，把这个主题做充实。<br>之前已经完成了vsphere和vcenter的安装配置，接下来就要真的开始创建虚拟机了。</p>
<h2 id="创建虚拟机">创建虚拟机</h2><p>首先要创建资源组<br><img src="/images/vmachine/vm-1.png" alt="vm-1"><br>在创建的资源组内新建虚拟机<br><img src="/images/vmachine/vm-2.png" alt="vm-2"><br>指定虚拟机名称，选择虚拟机所在的数据中心<br><img src="/images/vmachine/vm-3.png" alt="vm-3"><br>选择计算资源<br><img src="/images/vmachine/vm-4.png" alt="vm-4"><br>选择存储器，类型为Thin provision<br><img src="/images/vmachine/vm-5.png" alt="vm-5"><br>选择兼容性，ESXi 6.0及更高版本<br><img src="/images/vmachine/vm-6.png" alt="vm-6"><br>选择客户机操作系统<br><img src="/images/vmachine/vm-7.png" alt="vm-7"><br>自定义硬件-CPU<br><img src="/images/vmachine/vm-8.png" alt="vm-8"><br>自定义硬件-MEMORY<br><img src="/images/vmachine/vm-9.png" alt="vm-9"><br>自定义硬件-DISK<br><img src="/images/vmachine/vm-10.png" alt="vm-10"><br>自定义硬件-NETWORK<br><img src="/images/vmachine/vm-11.png" alt="vm-11"></p>
<h2 id="创建虚拟机自定义规范">创建虚拟机自定义规范</h2><p>通过使用自定义规范，可以自动配置新建虚拟机的主机名、IP地址信息，另外，最大的好处是在windows虚拟机克隆时自动生成不同的SID<br>新建自定义规范<br><img src="/images/vprofile/pro-1.png" alt="pro-1"><br>设置注册信息<br><img src="/images/vprofile/pro-2.png" alt="pro-2"><br>设置主机名，通过附加数值保证唯一性<br><img src="/images/vprofile/pro-3.png" alt="pro-3"><br>输入windows许可证<br><img src="/images/vprofile/pro-4.png" alt="pro-4"><br>设置管理员密码<br><img src="/images/vprofile/pro-5.png" alt="pro-5"><br>设置时区<br><img src="/images/vprofile/pro-6.png" alt="pro-6"><br>编辑网络<br><img src="/images/vprofile/pro-7.png" alt="pro-7"><br>设置工作组或域<br><img src="/images/vprofile/pro-8.png" alt="pro-8"><br>设置操作系统选项<br><img src="/images/vprofile/pro-9.png" alt="pro-9"><br>完成配置<br><img src="/images/vprofile/pro-10.png" alt="pro-10"></p>
<h2 id="虚拟机模板">虚拟机模板</h2><p>为不同应用创建虚拟机模板，通过模板可以快速部署虚拟机。<br>选择名称和文件夹<br><img src="/images/vtemplate/tem-1.png" alt="tem-1"><br>选择计算资源<br><img src="/images/vtemplate/tem-2.png" alt="tem-2"><br>选择存储器<br><img src="/images/vtemplate/tem-3.png" alt="tem-3"><br>选择克隆选项<br><img src="/images/vtemplate/tem-4.png" alt="tem-4"><br>选择先前创建的规范<br><img src="/images/vtemplate/tem-5.png" alt="tem-5"><br>网络设置<br><img src="/images/vtemplate/tem-6.png" alt="tem-6"><br>完成部署<br><img src="/images/vtemplate/tem-7.png" alt="tem-7"><br>至此，介绍完了虚拟机的创建、自定义规范创建、以及通过模板部署虚拟机。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/24/Create vMachine & Profile/" data-id="cijv4jwvx000hd8iaxhm7p5aj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Vmware vsphere &amp; vcenter configuration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/17/Vmware vsphere & vcenter configuration/" class="article-date">
  <time datetime="2016-01-17T05:35:53.000Z" itemprop="datePublished">2016-01-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/VMware/">VMware</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/17/Vmware vsphere & vcenter configuration/">VMware vsphere &amp; vcenter configuration</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>天气依然很冷，但工作还是要做的，继续上一篇来讲讲vsphere6.0的配置。</p>
<h2 id="创建数据中心">创建数据中心</h2><p>首先要创建数据中心<br><img src="/images/vdatacenter/dc-1.png" alt="dc-1"><br>之后是创建集群，可以开启vsphere HA和DRS功能<br><img src="/images/vdatacenter/dc-2.png" alt="dc-2"><br>使用vmware虚拟化后，省去先前关键业务主机必须要配置双机的麻烦，可以使用vpshere自带的HA功能实现应用包含。对于特别关键的业务还可以使用Fault Tolerance功能，vsphere 6.0版本开始FT支持每个虚拟机可以配置4vCPU。<br>添加主机到新创建的集群<br><img src="/images/vdatacenter/dc-3.png" alt="dc-3"><br>输入用户名密码，验证ESXi主机<br><img src="/images/vdatacenter/dc-4.png" alt="dc-4"><br>完成ESXi主机添加<br><img src="/images/vdatacenter/dc-5.png" alt="dc-5"></p>
<h2 id="配置网络">配置网络</h2><p>vsphere网络配置分为标准交换机和分布式交换机。通俗讲标准交换机就是每台ESXi主机单独配置网络，分布式交换机则是在vcenter中创建交换机，并将各ESXi主机加入到分布式交换机。对于主机很多的集群，可以使用分布式交换机，简化配置步骤。<br>在我们的集群中，使用分布式交换机作为业务网络，使用标准交换机作为管理网络。</p>
<h3 id="配置标准交换机">配置标准交换机</h3><p>标准交换机除作为管理网络，还可作为vmotion网络。vsphere6.0开始支持跨vcenter的vmotion，研究出来后再写一篇分享。<br>添加网络，选择VMKernel网络适配器<br><img src="/images/vnetwork/net-1.png" alt="net-1"><br>选择目标设备为现有标准交换机<br><img src="/images/vnetwork/net-2.png" alt="net-2"><br>设置端口属性<br><img src="/images/vnetwork/net-3.png" alt="net-3"><br>配置IP地址<br><img src="/images/vnetwork/net-4.png" alt="net-4"></p>
<h3 id="配置分布式交换机">配置分布式交换机</h3><p>新建Distributed Switch<br><img src="/images/vnetwork/net-5.png" alt="net-5"><br>选择版本<br><img src="/images/vnetwork/net-6.png" alt="net-6"><br>编辑设置，选择上行链路，可以先不创建端口组<br><img src="/images/vnetwork/net-7.png" alt="net-7"><br>分布式交换机创建完成<br><img src="/images/vnetwork/net-8.png" alt="net-8"><br>为分布式交换机添加主机<br><img src="/images/vnetwork/net-9.png" alt="net-9"><br>添加集群内所有主机<br><img src="/images/vnetwork/net-10.png" alt="net-10"><br>选择网络适配器任务<br><img src="/images/vnetwork/net-11.png" alt="net-11"><br>分配上行链路<br><img src="/images/vnetwork/net-12.png" alt="net-12"><br>添加主机完成<br><img src="/images/vnetwork/net-13.png" alt="net-13"><br>新建分布式端口组<br><img src="/images/vnetwork/net-14.png" alt="net-14"><br>配置设置<br><img src="/images/vnetwork/net-15.png" alt="net-15"><br>配置完成<br><img src="/images/vnetwork/net-16.png" alt="net-16"><br>至此，完成Datacenter网络部分配置，vsphere基础环境配置完成，可以开始创建虚拟机啦！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/17/Vmware vsphere & vcenter configuration/" data-id="cijgzm2r8000wb0iay4psavs1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Vmware vsphere &amp; vcenter installation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/16/Vmware vsphere & vcenter installation/" class="article-date">
  <time datetime="2016-01-16T05:35:53.000Z" itemprop="datePublished">2016-01-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/VMware/">VMware</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/16/Vmware vsphere & vcenter installation/">VMware vsphere &amp; vcenter installation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>元旦过后又是漫长的出差生活，也真正开始体会南方湿冷的冬天。断断续续的下了一周雨，10多度的气温不算低，但总是有股刺骨的凉。终于到了周末，懒得出门，床上看完了池大的《MacTalk 人生元编程》，计划着什么时候自己也去买个MAC。<br>想买MAC就要更努力的工作，这一周开始使用vmware 6.0搭建虚拟化平台，趁着周末闲下来的午后，来整理下这一周的工作。<br>之前用过vmware 5.5，所以上手也就比较快。</p>
<h2 id="vsphere_6-0安装">vsphere 6.0安装</h2><p>vsphere 6.0相比之前的5.5版本在最大支持特性上有了很大的提高，具体比较如下：<br><img src="/images/vsphere/ESXi6-0.png" alt="ESXi6-0"><br>下载了最新的补丁，开机加载安装镜像，还是熟悉的画面<br><img src="/images/vsphere/ESXi6-1.png" alt="ESXi6-1"><br>安装镜像加载正常<br><img src="/images/vsphere/ESXi6-2.png" alt="ESXi6-2"><br>选择Enter开始安装<br><img src="/images/vsphere/ESXi6-3.png" alt="ESXi6-3"><br>选择F11接受License并继续<br><img src="/images/vsphere/ESXi6-4.png" alt="ESXi6-4"><br>选择将软件安装在本地系统盘<br><img src="/images/vsphere/ESXi6-5.png" alt="ESXi6-5"><br>设置默认键盘布局<br><img src="/images/vsphere/ESXi6-6.png" alt="ESXi6-6"><br>设置root密码<br><img src="/images/vsphere/ESXi6-7.png" alt="ESXi6-7"><br>确认安装<br><img src="/images/vsphere/ESXi6-8.png" alt="ESXi6-8"><br>完成安装并重启<br><img src="/images/vsphere/ESXi6-9.png" alt="ESXi6-9"><br>设置ESXi主机IP地址<br><img src="/images/vsphere/ESXi6-10.png" alt="ESXi6-10"><br>设置ESXi主机DNS、主机名信息<br><img src="/images/vsphere/ESXi6-11.png" alt="ESXi6-11"></p>
<h2 id="VCSA_6-0安装">VCSA 6.0安装</h2><p>相比常用的Windows版的vcenter server，还是Linux版的VCSA部署起来方便，并且在各项指标的支持上已经与Windows版的完全一致。6.0版本的VCSA安装上与先前的版本有了较大的变化，5.5版本的VCSA作为虚拟机模板直接部署，现在需要先安装插件，再通过网页的方式进行部署。<br>选择安装<br><img src="/images/vcenter/vcenter6-1.png" alt="vcenter6-1"><br>选择接受最终用户许可协议<br><img src="/images/vcenter/vcenter6-2.png" alt="vcenter6-2"><br>填写VCSA部署主机信息，包括IP地址、用户名和密码<br><img src="/images/vcenter/vcenter6-3.png" alt="vcenter6-3"><br>设置VCSA虚拟机信息<br><img src="/images/vcenter/vcenter6-4.png" alt="vcenter6-4"><br>因为是较小的vcenter，选择嵌入式Platform Services Controller<br><img src="/images/vcenter/vcenter6-5.png" alt="vcenter6-5"><br>设置单点登录<br><img src="/images/vcenter/vcenter6-6.png" alt="vcenter6-6"><br>选择设备大小为中型<br><img src="/images/vcenter/vcenter6-7.png" alt="vcenter6-7"><br>将VCSA部署在共享存储上<br><img src="/images/vcenter/vcenter6-8.png" alt="vcenter6-8"><br>使用嵌入式数据库PostgreSQL<br><img src="/images/vcenter/vcenter6-9.png" alt="vcenter6-9"><br>VCSA网络设置<br><img src="/images/vcenter/vcenter6-10.png" alt="vcenter6-10"><br>单机完成，开始部署<br><img src="/images/vcenter/vcenter6-11.png" alt="vcenter6-11"><br>安装完成，可以通过web client管理vcenter<br><img src="/images/vcenter/vcenter6-111.png" alt="vcenter6-12"><br>今天就先写这么多吧，办公室里实在是又冻手又冻脚，找个暖和的时候再继续写。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/16/Vmware vsphere & vcenter installation/" data-id="cijgzlu03000ub0iatizlsdeb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Huawei E9000 Switch Module" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/24/Huawei E9000 Switch Module/" class="article-date">
  <time datetime="2015-12-24T08:22:53.000Z" itemprop="datePublished">2015-12-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/VMware/">VMware</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/24/Huawei E9000 Switch Module/">Huawei E9000 Switch Module Configure</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>万事开头难！新搭建的博客平台有一个多月了，今天终于鼓起勇气在这个凄惨的平安夜里来写点什么。最近两天一直在鼓捣华为的E9000刀箱，好好的研究了下它的交换模块。<br>先说下我们的配置吧，1台E9000刀框，2个CX110以太网交换模块，2个CX210 SAN网络交换模块。7台CH240全宽刀片，每台分别安装MZ110和MZ910卡。<br>刀框背后有两个MM910管理模块（主备关系），默认IP地址分别为192.168.2.1/2，虚拟地址192.168.2.3。可以插4个交换模块，还是来个图比较直观：<br><img src="/images/E9000/E9000.png" alt="E9000"><br>刀框SAN网络交换模块连接SNS2248光纤交换机，以太网交换模块连接CE12808网络交换机。计算节点Mezz卡与交换模块对应关系如下（原谅我图画的比较丑）：<br><img src="/images/E9000/Mezz.png" alt="Mezz_to_switch_module"></p>
<h2 id="CX210_SAN交换模块配置">CX210 SAN交换模块配置</h2><p>CX210可以理解为一台对外8个8GB FC接口的SAN交换机，对内16个8GB FC接口分别对应各个槽位的计算节点，具体对应关系稍后会有详细说明。<br>对外的FC接口连接华为SNS2248光纤交换机，当CX210上连另一台SAN交换机时会有两种模式：<br>1）设置CX210为AG（Access Gateway）模式，以N-PORT方式上连，在上连的交换机上为其配置Zone；<br>2）设置CX210为Native模式（默认情况），以E-PORT方式上连，也就是我们常说的交换机级联；<br>由于没有买级联的License，所以我们也只能将CX210配置为AG模式。</p>
<p>介绍配置步骤前先来普及下SAN交换机端口类型：<br>N端口：Node Port节点端口；节点连接点，光纤通道通信的终端；<br>E端口：Expansion Port 扩展端口；用于通过ISL（内部交换链接）连接多个交换机<br>F端口：Fabric Port 光纤端口；一种交换连接端口，也就是两个N端口连接的”中间端口”<br>G端口：Generic Port 通用端口；可根据连接方式，在F端口和E端口之间进行切换</p>
<h3 id="CX210_AG模式配置方法">CX210 AG模式配置方法</h3><p>检查CX210当前配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">FC_SW:admin&gt; switchshow </span><br><span class="line">switchName:     FC_SW</span><br><span class="line">switchType:     <span class="number">134.1</span></span><br><span class="line">switchState:    Online   </span><br><span class="line">switchMode:     Native</span><br><span class="line">switchRole:     Principal</span><br><span class="line">switchDomain:   <span class="number">1</span></span><br><span class="line">switchId:       fffc01</span><br><span class="line">switchWwn:      <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:e0:<span class="number">58</span>:a4</span><br><span class="line">zoning:         OFF</span><br><span class="line">switchBeacon:   OFF</span><br><span class="line"></span><br><span class="line">Index Port Address Media Speed       State   Proto</span><br><span class="line">==================================================</span><br><span class="line">   <span class="number">0</span>   <span class="number">0</span>   <span class="number">010000</span>   cu    <span class="number">8</span>G       No_Sync     FC  Disabled (Persistent) </span><br><span class="line">   <span class="number">1</span>   <span class="number">1</span>   <span class="number">010100</span>   id    N8       Online      FC  E-Port  segmented,<span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:ba:<span class="number">71</span>:d3 (No Fabric License)</span><br><span class="line">   <span class="number">2</span>   <span class="number">2</span>   <span class="number">010200</span>   id    N8       Online      FC  E-Port  segmented,<span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:ba:<span class="number">71</span>:d3 (No Fabric License)</span><br><span class="line">   <span class="number">3</span>   <span class="number">3</span>   <span class="number">010300</span>   id    N8       No_Light    FC  </span><br><span class="line">   <span class="number">4</span>   <span class="number">4</span>   <span class="number">010400</span>   id    N8       No_Light    FC  </span><br><span class="line">   <span class="number">5</span>   <span class="number">5</span>   <span class="number">010500</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">6</span>   <span class="number">6</span>   <span class="number">010600</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">7</span>   <span class="number">7</span>   <span class="number">010700</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">8</span>   <span class="number">8</span>   <span class="number">010800</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">9</span>   <span class="number">9</span>   <span class="number">010900</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">10</span>  <span class="number">10</span>   <span class="number">010</span>a00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">11</span>  <span class="number">11</span>   <span class="number">010</span>b00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">12</span>  <span class="number">12</span>   <span class="number">010</span>c00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">13</span>  <span class="number">13</span>   <span class="number">010</span>d00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">14</span>  <span class="number">14</span>   <span class="number">010</span>e00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">15</span>  <span class="number">15</span>   <span class="number">010</span>f00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">16</span>  <span class="number">16</span>   <span class="number">011000</span>   cu    <span class="number">8</span>G       No_Sync     FC  Disabled (Persistent) </span><br><span class="line">  <span class="number">17</span>  <span class="number">17</span>   <span class="number">011100</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">18</span>  <span class="number">18</span>   <span class="number">011200</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">19</span>  <span class="number">19</span>   <span class="number">011300</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">20</span>  <span class="number">20</span>   <span class="number">011400</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">21</span>  <span class="number">21</span>   <span class="number">011500</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">22</span>  <span class="number">22</span>   <span class="number">011600</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">23</span>  <span class="number">23</span>   <span class="number">011700</span>   cu    <span class="number">8</span>G       No_Sync     FC</span><br></pre></td></tr></table></figure></p>
<p>默认情况下CX210为Native模式，连接到SNS2248交换机的端口状态为E-PORT，但没有级联License。</p>
<p>将CX210修改为AG模式<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">FC_SW:admin&gt; switchdisable</span><br><span class="line"></span><br><span class="line">FC_SW:admin&gt; ag --modeenable</span><br><span class="line">WARNING: Access Gateway mode changes the standard behavior of the switch. Please check Access Gateway Administrator<span class="string">'s Guide before proceeding.</span><br><span class="line">Enabling agmode will remove all the configuration data on the switch</span><br><span class="line">including zoning configuration, FAWWN configuration and security database. Please backup your</span><br><span class="line">configuration using configupload.</span><br><span class="line">This operation will reboot the switch.</span><br><span class="line">Do you want to continue? (yes, y, no, n): [no] y</span><br><span class="line">ERROR: AG mode not allowed while AUTHENTICATION policies are enabled. </span><br><span class="line">Please disable the AUTHENTICATION policies using the CLI authutil --policy -sw(switch)/-dev(device)</span><br><span class="line"></span><br><span class="line">FC_SW:admin&gt; authutil --policy -sw off</span><br><span class="line">Warning: Activating the authentication policy requires either DH-CHAP secrets or PKI certificates depending on the protocol selected. Otherwise, ISLs will be segmented during next E-port bring-up. </span><br><span class="line">ARE YOU SURE  (yes, y, no, n): [no] y</span><br><span class="line">Auth Policy is set to OFF</span><br><span class="line"></span><br><span class="line">FC_SW:admin&gt; ag --modeenable</span><br><span class="line">WARNING: Access Gateway mode changes the standard behavior of the switch. Please check Access Gateway Administrator'</span>s Guide before proceeding.</span><br><span class="line">Enabling agmode will remove all the configuration data on the switch</span><br><span class="line">including zoning configuration, FAWWN configuration and security database. Please backup your</span><br><span class="line">configuration using configupload.</span><br><span class="line">This operation will reboot the switch.</span><br><span class="line">Do you want to <span class="built_in">continue</span>? (yes, y, no, n): [no] y</span><br><span class="line">Access Gateway mode was enabled successfully</span><br><span class="line">Switch is being rebooted...</span><br><span class="line">Please change passwords <span class="keyword">for</span> switch default accounts now.</span><br><span class="line">Use Control-C to <span class="built_in">exit</span> or press <span class="string">'Enter'</span> key to proceed.</span><br></pre></td></tr></table></figure></p>
<p>配置完成后，CX210交换模块自动重启。重启后检查交换机配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">FC_SW:admin&gt; switchshow </span><br><span class="line">switchName:     FC_SW</span><br><span class="line">switchType:     <span class="number">134.1</span></span><br><span class="line">switchState:    Online   </span><br><span class="line">switchMode:     Access Gateway Mode</span><br><span class="line">switchWwn:      <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:e0:<span class="number">58</span>:a4</span><br><span class="line">switchBeacon:   OFF</span><br><span class="line"></span><br><span class="line">Index Port Address Media Speed       State   Proto</span><br><span class="line">==================================================</span><br><span class="line">   <span class="number">0</span>   <span class="number">0</span>   <span class="number">010000</span>   cu    <span class="number">8</span>G       No_Sync     FC  Disabled (Persistent) </span><br><span class="line">   <span class="number">1</span>   <span class="number">1</span>   <span class="number">010100</span>   id    N8       Online      FC  N-Port  <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:ba:<span class="number">71</span>:d3 <span class="number">0</span>x010400 (AoQ) </span><br><span class="line">   <span class="number">2</span>   <span class="number">2</span>   <span class="number">010200</span>   id    N8       Online      FC  N-Port  <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:ba:<span class="number">71</span>:d3 <span class="number">0</span>x010500 (AoQ) </span><br><span class="line">   <span class="number">3</span>   <span class="number">3</span>   <span class="number">010300</span>   id    N8       No_Light    FC  </span><br><span class="line">   <span class="number">4</span>   <span class="number">4</span>   <span class="number">010400</span>   id    N8       No_Light    FC  </span><br><span class="line">   <span class="number">5</span>   <span class="number">5</span>   <span class="number">010500</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">6</span>   <span class="number">6</span>   <span class="number">010600</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">7</span>   <span class="number">7</span>   <span class="number">010700</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">8</span>   <span class="number">8</span>   <span class="number">010800</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">9</span>   <span class="number">9</span>   <span class="number">010900</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">10</span>  <span class="number">10</span>   <span class="number">010</span>a00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">11</span>  <span class="number">11</span>   <span class="number">010</span>b00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">12</span>  <span class="number">12</span>   <span class="number">010</span>c00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">13</span>  <span class="number">13</span>   <span class="number">010</span>d00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">14</span>  <span class="number">14</span>   <span class="number">010</span>e00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">15</span>  <span class="number">15</span>   <span class="number">010</span>f00   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">16</span>  <span class="number">16</span>   <span class="number">011000</span>   cu    <span class="number">8</span>G       No_Sync     FC  Disabled (Persistent) </span><br><span class="line">  <span class="number">17</span>  <span class="number">17</span>   <span class="number">011100</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">18</span>  <span class="number">18</span>   <span class="number">011200</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">19</span>  <span class="number">19</span>   <span class="number">011300</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">20</span>  <span class="number">20</span>   <span class="number">011400</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">21</span>  <span class="number">21</span>   <span class="number">011500</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">22</span>  <span class="number">22</span>   <span class="number">011600</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">23</span>  <span class="number">23</span>   <span class="number">011700</span>   cu    <span class="number">8</span>G       No_Sync     FC</span><br></pre></td></tr></table></figure></p>
<p>  CX210模式已经改为AG模式，上连端口类型为N-PORT</p>
<h3 id="端口映射">端口映射</h3><p>  前面已经提到除了对外连接的8个FC接口，还有对应计算节点的16个FC接口。这些接口是如何映射出来的呢？默认对应关系如下：<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  FC_SW:admin&gt; ag --mapshow</span><br><span class="line">N_Port  Configured_F_Ports      Static_F_Ports  Current_F_Ports Failover Failback PG_ID PG_Name</span><br><span class="line">------------------------------------------------------------------------------------------------</span><br><span class="line">   <span class="number">1</span>    <span class="number">9</span>;<span class="number">17</span>                    None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">2</span>    <span class="number">10</span>;<span class="number">18</span>                   None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">3</span>    <span class="number">11</span>;<span class="number">19</span>                   None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">4</span>    <span class="number">12</span>;<span class="number">20</span>                   None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">5</span>    <span class="number">13</span>;<span class="number">21</span>                   None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">6</span>    <span class="number">14</span>;<span class="number">22</span>                   None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">7</span>    <span class="number">15</span>;<span class="number">23</span>                   None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">   <span class="number">8</span>    <span class="number">0</span>;<span class="number">16</span>                    None            None             <span class="number">1</span>       <span class="number">1</span>         <span class="number">0</span>    pg0</span><br><span class="line">------------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>由于我们在CX210交换模块上仅激活了前4个FC接口，需要手动修改端口映射关系，不然有的计算节点就要连不出去了。。。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">1</span> <span class="string">"9;17"</span>       </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">2</span> <span class="string">"10;18"</span>      </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">3</span> <span class="string">"11;19"</span>      </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">4</span> <span class="string">"12;20"</span>      </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">5</span> <span class="string">"13;21"</span>      </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">6</span> <span class="string">"14;22"</span>      </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">7</span> <span class="string">"15;23"</span>      </span><br><span class="line">  FC_SW:admin&gt; ag --mapdel <span class="number">8</span> <span class="string">"16;0"</span>       </span><br><span class="line">                             </span><br><span class="line">  FC_SW:admin&gt; ag --mapadd <span class="number">1</span> <span class="string">"9;10;17;18"</span> </span><br><span class="line">  FC_SW:admin&gt; ag --mapadd <span class="number">2</span> <span class="string">"11;12;19;20"</span></span><br><span class="line">  FC_SW:admin&gt; ag --mapadd <span class="number">3</span> <span class="string">"13;14;21;22"</span></span><br><span class="line">  FC_SW:admin&gt; ag --mapadd <span class="number">4</span> <span class="string">"15;16;23;0"</span> </span><br><span class="line"></span><br><span class="line">FC_SW:admin&gt; ag --mapshow</span><br><span class="line">N_Port  Configured_F_Ports      Static_F_Ports  Current_F_Ports Failover Failback PG_ID        PG_Name</span><br><span class="line">------------------------------------------------------------------------------------------------</span><br><span class="line">   <span class="number">1</span>    <span class="number">9</span>;<span class="number">10</span>;<span class="number">17</span>;<span class="number">18</span>              None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">2</span>    <span class="number">11</span>;<span class="number">12</span>;<span class="number">19</span>;<span class="number">20</span>             None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">3</span>    <span class="number">13</span>;<span class="number">14</span>;<span class="number">21</span>;<span class="number">22</span>             None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">4</span>    <span class="number">0</span>;<span class="number">15</span>;<span class="number">16</span>;<span class="number">23</span>              None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">5</span>    None                    None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">6</span>    None                    None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">7</span>    None                    None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">   <span class="number">8</span>    None                    None            None             <span class="number">1</span>       <span class="number">1</span>       <span class="number">0</span>     pg0</span><br><span class="line">------------------------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p>最后就是激活端口，内部连接的端口类型为F-Port<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">  FC_SW:admin&gt; portenable <span class="number">1</span></span><br><span class="line">  FC_SW:admin&gt; portenable <span class="number">2</span></span><br><span class="line">  FC_SW:admin&gt; portenable <span class="number">3</span></span><br><span class="line">  FC_SW:admin&gt; portenable <span class="number">4</span></span><br><span class="line"></span><br><span class="line">  FC_SW:root&gt; switchshow </span><br><span class="line">switchName:     FC_SW</span><br><span class="line">switchType:     <span class="number">134.1</span></span><br><span class="line">switchState:    Online   </span><br><span class="line">switchMode:     Access Gateway Mode</span><br><span class="line">switchWwn:      <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:e0:<span class="number">48</span>:ca</span><br><span class="line">switchBeacon:   OFF</span><br><span class="line"></span><br><span class="line">Index Port Address Media Speed       State   Proto</span><br><span class="line">==================================================</span><br><span class="line">   <span class="number">0</span>   <span class="number">0</span>   <span class="number">010000</span>   cu    <span class="number">8</span>G       No_Sync     FC  Disabled (Persistent) </span><br><span class="line">   <span class="number">1</span>   <span class="number">1</span>   <span class="number">010100</span>   id    N8       Online      FC  N-Port  <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:ba:<span class="number">71</span>:d3 <span class="number">0</span>x0d0000 (AoQ) </span><br><span class="line">   <span class="number">2</span>   <span class="number">2</span>   <span class="number">010200</span>   id    N8       Online      FC  N-Port  <span class="number">10</span>:<span class="number">00</span>:<span class="number">50</span>:eb:<span class="number">1</span>a:ba:<span class="number">71</span>:d3 <span class="number">0</span>x0d0100 (AoQ) </span><br><span class="line">   <span class="number">3</span>   <span class="number">3</span>   <span class="number">010300</span>   id    N8       No_Light    FC  </span><br><span class="line">   <span class="number">4</span>   <span class="number">4</span>   <span class="number">010400</span>   id    N8       No_Light    FC  </span><br><span class="line">   <span class="number">5</span>   <span class="number">5</span>   <span class="number">010500</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">6</span>   <span class="number">6</span>   <span class="number">010600</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">7</span>   <span class="number">7</span>   <span class="number">010700</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">8</span>   <span class="number">8</span>   <span class="number">010800</span>   --    N8       No_Module   FC  (No POD License) Disabled</span><br><span class="line">   <span class="number">9</span>   <span class="number">9</span>   <span class="number">010900</span>   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c7:fb:<span class="number">15</span> <span class="number">0</span>x0d0001 </span><br><span class="line">  <span class="number">10</span>  <span class="number">10</span>   <span class="number">010</span>a00   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c6:<span class="number">8</span>d:<span class="number">14</span> <span class="number">0</span>x0d0002 </span><br><span class="line">  <span class="number">11</span>  <span class="number">11</span>   <span class="number">010</span>b00   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c6:ac:<span class="number">12</span> <span class="number">0</span>x0d0101 </span><br><span class="line">  <span class="number">12</span>  <span class="number">12</span>   <span class="number">010</span>c00   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c6:<span class="number">8</span>d:<span class="number">00</span> <span class="number">0</span>x0d0102 </span><br><span class="line">  <span class="number">13</span>  <span class="number">13</span>   <span class="number">010</span>d00   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c7:fb:<span class="number">07</span> <span class="number">0</span>x0d0005 </span><br><span class="line">  <span class="number">14</span>  <span class="number">14</span>   <span class="number">010</span>e00   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c6:<span class="number">8</span>c:d8 <span class="number">0</span>x0d0004 </span><br><span class="line">  <span class="number">15</span>  <span class="number">15</span>   <span class="number">010</span>f00   cu    <span class="number">8</span>G       Online      FC  F-Port  <span class="number">10</span>:<span class="number">00</span>:e0:<span class="number">36</span>:<span class="number">76</span>:c6:<span class="number">8</span>d:<span class="number">9</span>b <span class="number">0</span>x0d0003 </span><br><span class="line">  <span class="number">16</span>  <span class="number">16</span>   <span class="number">011000</span>   cu    <span class="number">8</span>G       No_Sync     FC  Disabled (Persistent) </span><br><span class="line">  <span class="number">17</span>  <span class="number">17</span>   <span class="number">011100</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">18</span>  <span class="number">18</span>   <span class="number">011200</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">19</span>  <span class="number">19</span>   <span class="number">011300</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">20</span>  <span class="number">20</span>   <span class="number">011400</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">21</span>  <span class="number">21</span>   <span class="number">011500</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">22</span>  <span class="number">22</span>   <span class="number">011600</span>   cu    <span class="number">8</span>G       No_Sync     FC  </span><br><span class="line">  <span class="number">23</span>  <span class="number">23</span>   <span class="number">011700</span>   cu    <span class="number">8</span>G       No_Sync     FC</span><br></pre></td></tr></table></figure></p>
<p>现在可以连接SAN交换机，分配存储，开始我们的VMware虚拟化之旅</p>
<h2 id="CX110_以太网交换机模块配置">CX110 以太网交换机模块配置</h2><p>有了共享存储，还需要所有计算节点能够和外部系统连通，这就需要配置CX110以太网交换模块。<br>CX110交换模块对外接口包括4个万兆光口和12个千兆电口，GE电口子卡号为17，取值为1~12；10GE光口子卡号为20，取值为1~4；可以通过任意端口与外部互连。<br>CX110交换模块对内接口包括与前插半宽槽位对应的GE接口以及40GE接口，GE接口子卡号为1~16，取值为1~2，与前插半宽槽位slot01~slot16对应；40GE接口子卡号为18，取值为1~2，实现1E和4E槽位的交换模块或2X和3X槽位的交换模块互连。<br>CX110交换模块GE接口子卡号为19，取值为1~2，2个GE接口分别用于和MM910通信。</p>
<h3 id="配置CX110交换模块堆叠">配置CX110交换模块堆叠</h3><p>两个CX110交换模块堆叠域要求配置一致，优先级高的为主，默认优先级为100。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[~HUAWEI]stack</span><br><span class="line">[~HUAWEI-stack]stack member <span class="number">1</span> domain <span class="number">10</span> </span><br><span class="line">Info: The operation takes effect only after the save <span class="built_in">command</span> is executed. The device with a lower priority <span class="keyword">then</span> will be reset <span class="keyword">in</span> the stack merging scenario.</span><br><span class="line"></span><br><span class="line">[*HUAWEI-stack]stack member <span class="number">1</span> priority <span class="number">150</span> </span><br><span class="line">Info: The operation will take effect after reboot.</span><br><span class="line">[*HUAWEI-stack]commit</span><br></pre></td></tr></table></figure></p>
<p>将两个40GE接口配置为堆叠模式，并加入到堆叠端口<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[~HUAWEI]interface <span class="number">40</span>GE <span class="number">1</span>/<span class="number">18</span>/<span class="number">1</span> </span><br><span class="line">[~HUAWEI-<span class="number">40</span>GE1/<span class="number">18</span>/<span class="number">1</span>]port mode stack </span><br><span class="line">[*HUAWEI-<span class="number">40</span>GE1/<span class="number">18</span>/<span class="number">1</span>]commit</span><br><span class="line">[~HUAWEI-<span class="number">40</span>GE1/<span class="number">18</span>/<span class="number">1</span>]quit</span><br><span class="line"></span><br><span class="line">[~HUAWEI]interface <span class="number">40</span>GE <span class="number">1</span>/<span class="number">18</span>/<span class="number">2</span> </span><br><span class="line">[~HUAWEI-<span class="number">40</span>GE1/<span class="number">18</span>/<span class="number">2</span>]port mode stack </span><br><span class="line">[*HUAWEI-<span class="number">40</span>GE1/<span class="number">18</span>/<span class="number">2</span>]commit</span><br><span class="line">[~HUAWEI-<span class="number">40</span>GE1/<span class="number">18</span>/<span class="number">2</span>]quit</span><br><span class="line"></span><br><span class="line">[~HUAWEI]interface Stack-Port <span class="number">1</span>/<span class="number">1</span></span><br><span class="line">[*HUAWEI-Stack-Port1/<span class="number">1</span>]port member-group interface <span class="number">40</span>GE <span class="number">1</span>/<span class="number">18</span>/<span class="number">1</span> to <span class="number">1</span>/<span class="number">18</span>/<span class="number">2</span> </span><br><span class="line">[*HUAWEI-Stack-Port1/<span class="number">1</span>]commit</span><br><span class="line">[~HUAWEI-Stack-Port1/<span class="number">1</span>]quit</span><br></pre></td></tr></table></figure></p>
<p>打开堆叠端口<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[~HUAWEI]interface range <span class="number">40</span>GE <span class="number">1</span>/<span class="number">18</span>/<span class="number">1</span> to <span class="number">40</span>GE <span class="number">1</span>/<span class="number">18</span>/<span class="number">2</span> </span><br><span class="line">[~HUAWEI-port-group]undo shutdown </span><br><span class="line">[*HUAWEI-port-group]commit</span><br><span class="line">[~HUAWEI-port-group]quit</span><br></pre></td></tr></table></figure></p>
<p>保存配置并重启<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;HUAWEI&gt;save </span><br><span class="line">Warning: The current configuration will be written to the device. Continue? [Y/N]:y</span><br><span class="line">Now saving the current configuration to the slot <span class="number">1</span> </span><br><span class="line">Info: Save the configuration successfully.</span><br><span class="line"></span><br><span class="line">slot <span class="number">1</span>: generate <span class="built_in">local</span> config file successfully.</span><br><span class="line">&lt;HUAWEI&gt;reboot </span><br><span class="line">slot <span class="number">1</span>:</span><br><span class="line">Next startup system software: flash:/CX110-Switch-V3.<span class="number">13</span>.cc</span><br><span class="line">Next startup saved-configuration file: flash:/vrpcfg.zip</span><br><span class="line">Next startup paf file: default</span><br><span class="line">Next startup patch package: flash:/CX110-Switch-V3.<span class="number">13</span>-SPH003.PAT</span><br><span class="line"></span><br><span class="line">begin synchronize configuration to SMM ...</span><br><span class="line">slot <span class="number">1</span>: configuration is the same with SMM, needn<span class="string">'t sync to SMM.</span><br><span class="line"></span><br><span class="line">Warning: The system will reboot. Continue? [Y/N]:y</span></span><br></pre></td></tr></table></figure></p>
<p>检查堆叠状态<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;HUAWEI&gt;display stack </span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">MemberID Role     MAC              Priority   Device Type     Bay/Chassis         </span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line"><span class="number">1</span>        Master   <span class="number">0</span>c45-baa5-<span class="number">4690</span>   <span class="number">150</span>        CX110           <span class="number">1</span>E/<span class="number">1</span>                </span><br><span class="line"><span class="number">4</span>        Standby  <span class="number">0</span>c45-baa5-<span class="number">4710</span>   <span class="number">100</span>        CX110           <span class="number">4</span>E/<span class="number">1</span>                </span><br><span class="line">----------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<h3 id="配置CX110交换模块上连">配置CX110交换模块上连</h3><p>使用4个万兆光口作为上连接口，通过绑定实现40G的上连带宽<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[~HUAWEI]interface Eth-Trunk <span class="number">24</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]trunkport <span class="number">10</span>GE <span class="number">1</span>/<span class="number">20</span>/<span class="number">1</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]trunkport <span class="number">10</span>GE <span class="number">1</span>/<span class="number">20</span>/<span class="number">2</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]trunkport <span class="number">10</span>GE <span class="number">4</span>/<span class="number">20</span>/<span class="number">1</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]trunkport <span class="number">10</span>GE <span class="number">4</span>/<span class="number">20</span>/<span class="number">2</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]commit</span><br><span class="line">[~HUAWEI-Eth-Trunk24]quit</span><br><span class="line"></span><br><span class="line">[~HUAWEI]display eth-trunk <span class="number">24</span></span><br><span class="line">Eth-Trunk24<span class="string">'s state information is:</span><br><span class="line">Working Mode: Normal        Hash Arithmetic: profile default</span><br><span class="line">Least Active-linknumber: 1  Max Bandwidth-affected-linknumber: 16</span><br><span class="line">Operating Status: up        Number of Up Ports in Trunk: 4</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">PortName                      Status      Weight</span><br><span class="line">10GE1/20/1                    Up          1          </span><br><span class="line">10GE1/20/2                    Up          1          </span><br><span class="line">10GE4/20/1                    Up          1          </span><br><span class="line">10GE4/20/2                    Up          1</span></span><br></pre></td></tr></table></figure></p>
<p>配置端口类型为trunk，并允许指定的vlan通过<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[~HUAWEI]vlan batch <span class="number">21</span> to <span class="number">35</span> <span class="number">50</span> to <span class="number">52</span></span><br><span class="line">[*HUAWEI]interface Eth-Trunk <span class="number">24</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]port link-type trunk </span><br><span class="line">[*HUAWEI-Eth-Trunk24]port trunk allow-pass vlan <span class="number">21</span> to <span class="number">35</span> <span class="number">50</span> to <span class="number">52</span></span><br><span class="line">[*HUAWEI-Eth-Trunk24]commit</span><br><span class="line">[~HUAWEI-Eth-Trunk24]quit</span><br></pre></td></tr></table></figure></p>
<p>最后，配置CX110对内的网络端口，刀片服务器就可以正常与外部通信啦！</p>
<p>第一篇啰啰嗦嗦的写了不少，准备好了刀片服务器环境，下面就要开始在上面部署VMware 6.0虚拟化平台了</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/24/Huawei E9000 Switch Module/" data-id="cijdtimeh0000j8iaz6p40zot" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle-12c/">Oracle 12c</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/VMware/">VMware</a><span class="category-list-count">6</span></li></ul>
    </div>
  </div>

  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/03/04/Oracle 12c RAC Backup/">Oracle 12c RAC Backup</a>
          </li>
        
          <li>
            <a href="/2016/03/03/Oracle 12c RAC installation/">Oracle 12c RAC Installation</a>
          </li>
        
          <li>
            <a href="/2016/01/29/vRealize Automation & Operations/">vRealize Automation &amp; Operations Manager</a>
          </li>
        
          <li>
            <a href="/2016/01/26/vsphere data protection & replication/">vSphere Data Protection &amp; Replication</a>
          </li>
        
          <li>
            <a href="/2016/01/24/Create vMachine & Profile/">Create vMachine &amp; Profile</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 gamblegod<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>